<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Supervision 2 – Research Methods for Land Economy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./supervision_3.html" rel="next">
<link href="./supervision_1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-13f3b9144cfbd4bffe19d1212ca92176.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="icons.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./supervision_2.html"><span class="chapter-title">Supervision 2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Research Methods for Land Economy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Welcome and Supervision Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Supervision 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formative_test_sup3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">In-Class Exercise Sup 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_formative_test_sup3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Solution to In-class Sup3</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lab-7-the-simple-linear-regression-model" id="toc-lab-7-the-simple-linear-regression-model" class="nav-link active" data-scroll-target="#lab-7-the-simple-linear-regression-model">🧪 Lab 7 — The Simple Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">🎯 Learning outcomes</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">🧰 Prerequisites</a></li>
  <li><a href="#the-general-model" id="toc-the-general-model" class="nav-link" data-scroll-target="#the-general-model">The General Model</a></li>
  </ul></li>
  <li><a href="#lab-8-prediction-with-the-linear-regression-model" id="toc-lab-8-prediction-with-the-linear-regression-model" class="nav-link" data-scroll-target="#lab-8-prediction-with-the-linear-regression-model">🧪 Lab 8 — Prediction with the Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes-1" id="toc-learning-outcomes-1" class="nav-link" data-scroll-target="#learning-outcomes-1">🎯 Learning outcomes</a></li>
  <li><a href="#prerequisites-1" id="toc-prerequisites-1" class="nav-link" data-scroll-target="#prerequisites-1">🧰 Prerequisites</a></li>
  <li><a href="#understanding-prediction-uncertainty-through-sampling-variability" id="toc-understanding-prediction-uncertainty-through-sampling-variability" class="nav-link" data-scroll-target="#understanding-prediction-uncertainty-through-sampling-variability">Understanding Prediction Uncertainty Through Sampling Variability</a></li>
  <li><a href="#estimated-variances-and-covariance-of-coefficients" id="toc-estimated-variances-and-covariance-of-coefficients" class="nav-link" data-scroll-target="#estimated-variances-and-covariance-of-coefficients">Estimated Variances and Covariance of Coefficients</a></li>
  <li><a href="#non-linear-relationships---when-straight-lines-dont-fit" id="toc-non-linear-relationships---when-straight-lines-dont-fit" class="nav-link" data-scroll-target="#non-linear-relationships---when-straight-lines-dont-fit">Non-Linear Relationships - When Straight Lines Don’t Fit</a></li>
  </ul></li>
  <li><a href="#lab-9-hypothesis-test-pvalue-testing-linear-combinations" id="toc-lab-9-hypothesis-test-pvalue-testing-linear-combinations" class="nav-link" data-scroll-target="#lab-9-hypothesis-test-pvalue-testing-linear-combinations">🧪 Lab 9 — Hypothesis Test, p‑Value &amp; Testing Linear Combinations</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes-2" id="toc-learning-outcomes-2" class="nav-link" data-scroll-target="#learning-outcomes-2">🎯 Learning Outcomes</a></li>
  <li><a href="#hypothesis-tests" id="toc-hypothesis-tests" class="nav-link" data-scroll-target="#hypothesis-tests">Hypothesis Tests</a></li>
  <li><a href="#introduction-why-hypothesis-testing-matters" id="toc-introduction-why-hypothesis-testing-matters" class="nav-link" data-scroll-target="#introduction-why-hypothesis-testing-matters">Introduction: Why Hypothesis Testing Matters</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#formative-test-this-test-does-not-carry-any-marks" id="toc-formative-test-this-test-does-not-carry-any-marks" class="nav-link" data-scroll-target="#formative-test-this-test-does-not-carry-any-marks">Formative Test (This test does NOT carry any marks)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Supervision 2</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">23 Oct 2025, 01:09</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="lab-7-the-simple-linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="lab-7-the-simple-linear-regression-model">🧪 Lab 7 — The Simple Linear Regression Model</h2>
<section id="learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes">🎯 Learning outcomes</h3>
<p>By the end of this lab you will be able to:</p>
<ol type="1">
<li>Understand the mathematical formulation of the simple linear regression model</li>
<li>Estimate regression coefficients using <code>lm()</code> in R</li>
<li>Interpret the intercept and slope parameters in an applied context</li>
<li>Extract and examine regression output using <code>summary()</code> and related functions</li>
<li>Visualize the fitted regression line on a scatter plot</li>
<li>Assess the quality of model fit using residuals and R-squared</li>
</ol>
<hr>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">🧰 Prerequisites</h3>
<ul>
<li>R (≥ 4.0) and RStudio installed</li>
<li>Completed Labs 1-6</li>
<li>Packages (install once):</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"PoEdata"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccolonescu/PoEdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p><strong>Summary.</strong> In simple linear regression, we use <strong>one independent variable</strong> to predict a <strong>dependent variable</strong>. The relationship is represented by a straight line with an intercept and a slope.</p>
<p><strong>Introduction.</strong> We explore the fundamentals of the Simple Linear Regression Model, a method to understand the relationship between two variables. This model is foundational for more advanced analyses.</p>
<p><strong>Key terms.</strong> The <strong>dependent variable</strong> <span class="math inline">\((y)\)</span> is what we aim to predict; the <strong>independent variable</strong>, <span class="math inline">\(x\)</span>, explains <span class="math inline">\(y\)</span>.</p>
</section>
<section id="the-general-model" class="level3">
<h3 class="anchored" data-anchor-id="the-general-model">The General Model</h3>
<p>Assume a linear relationship between the conditional expectation of (y) and (x):</p>
<p><span class="math display">\[
y_i = \beta_1 + \beta_2 x_i + e_i \tag{1}
\]</span></p>
<ul>
<li><span class="math inline">\(\beta_1\)</span>: intercept</li>
<li><span class="math inline">\(\beta_2\)</span>: slope<br>
</li>
<li><span class="math inline">\(e_i\)</span>: error term with variance <span class="math inline">\(\sigma^2\)</span><br>
</li>
<li><span class="math inline">\(i=1,\dots,N\)</span>: observation index</li>
</ul>
<p>The predicted (estimated) value of <span class="math inline">\(y\)</span> given <span class="math inline">\(x\)</span> is:</p>
<p><span class="math display">\[
\hat{y} = b_1 + b_2 x \tag{2}
\]</span></p>
<p>Assumptions:</p>
<ol type="i">
<li>non-random (x);</li>
<li>constant error variance (homoskedasticity);</li>
<li>errors uncorrelated across observations;</li>
<li><span class="math inline">\(E[e_i \mid x_i]=0\)</span>.</li>
</ol>
<section id="part-a.-example-food-expenditure-vs-income" class="level4">
<h4 class="anchored" data-anchor-id="part-a.-example-food-expenditure-vs-income">PART A. Example: Food Expenditure vs Income</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall to install the package PoEdata once if needed:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccolonescu/PoEdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"cps_small"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cps_small<span class="sc">$</span>educ, cps_small<span class="sc">$</span>wage, <span class="at">xlab=</span><span class="st">"Education"</span>, <span class="at">ylab=</span><span class="st">"Wage"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Food data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"food"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(food)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  food_exp income
1   115.22   3.69
2   135.98   4.39
3   119.34   4.75
4   114.96   6.03
5   187.05  12.47
6   243.92  12.98</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(food<span class="sc">$</span>income, food<span class="sc">$</span>food_exp,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(food<span class="sc">$</span>food_exp)),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(food<span class="sc">$</span>income)),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"weekly income in $100"</span>, <span class="at">ylab=</span><span class="st">"weekly food expenditure in $"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-b.-estimating-a-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="part-b.-estimating-a-linear-regression">PART B. Estimating a Linear Regression</h4>
<p>For the food data the model is</p>
<p><span class="math display">\[
\text{food\_exp}_i = \beta_1 + \beta_2\,\text{income}_i + e_i.\tag{3}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(food_exp <span class="sc">~</span> income, <span class="at">data =</span> food)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod1)[[<span class="dv">1</span>]]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod1)[[<span class="dv">2</span>]]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>smod1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>smod1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = food_exp ~ income, data = food)

Residuals:
     Min       1Q   Median       3Q      Max 
-223.025  -50.816   -6.324   67.879  212.044 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   83.416     43.410   1.922   0.0622 .  
income        10.210      2.093   4.877 1.95e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 89.52 on 38 degrees of freedom
Multiple R-squared:  0.385, Adjusted R-squared:  0.3688 
F-statistic: 23.79 on 1 and 38 DF,  p-value: 1.946e-05</code></pre>
</div>
</div>
<p>Add the regression line to the scatter plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(food<span class="sc">$</span>income, food<span class="sc">$</span>food_exp,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(food<span class="sc">$</span>food_exp)),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(food<span class="sc">$</span>income)),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"weekly income in $100"</span>, <span class="at">ylab=</span><span class="st">"weekly food expenditure in $"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"p"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(b1, b2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Retrieve common results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(smod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod1<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
   83.41600    10.20964 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>smod1<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 83.41600  43.410163 1.921578 6.218242e-02
income      10.20964   2.093264 4.877381 1.945862e-05</code></pre>
</div>
</div>
</section>
<section id="part-c.-mcqs" class="level4">
<h4 class="anchored" data-anchor-id="part-c.-mcqs">PART C. MCQs</h4>
<!-- FEEDBACK SCRIPT: sets .is-correct / .is-incorrect on the clicked label -->
<script>
(function () {
  const norm = s => (s || "").replace(/\s+/g, " ").trim();
  document.addEventListener("change", function (e) {
    const input = e.target.closest('.mcq-we-q input[type="radio"]');
    if (!input) return;

    // find the corresponding label (works for both nested and for= cases)
    const label = input.closest('label') || document.querySelector(`label[for="${input.id}"]`);
    if (!label) return;

    const q = label.closest(".mcq-we-q") || input.closest(".mcq-we-q");
    if (!q) return;

    const keyEl = q.querySelector(".mcq-key");
    if (!keyEl) return;

    const key = norm(keyEl.getAttribute("data-correct"));
    const choice = norm(label.textContent);

    // reset previous feedback in this question
    q.querySelectorAll("label").forEach(l => l.classList.remove("is-correct","is-incorrect"));

    // add feedback to the chosen option
    label.classList.add(choice === key ? "is-correct" : "is-incorrect");
  });
})();
</script>
<div class="mcq-we">
<div class="mcq-we-q">
<strong>1) What relationship does simple linear regression assume between y and x?</strong><br>

<div id="radio_TLVDOVWEYJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TLVDOVWEYJ" value=""> <span>Quadratic</span></label><label><input type="radio" autocomplete="off" name="radio_TLVDOVWEYJ" value=""> <span>Logarithmic</span></label><label><input type="radio" autocomplete="off" name="radio_TLVDOVWEYJ" value="answer"> <span>Linear</span></label><label><input type="radio" autocomplete="off" name="radio_TLVDOVWEYJ" value=""> <span>Exponential</span></label>
</div>
<span class="mcq-key" data-correct="Linear"></span>
<details class="hint">
<summary>
Hint
</summary>
Think straight line: one slope + one intercept.
</details>
<p>β</p>
</div>
<div class="mcq-we-q">
<strong>2) In the model y = β₀ + β₁ x + ε, what does β₁ represent?</strong><br>

<div id="radio_BQZNWMRMJL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BQZNWMRMJL" value=""> <span>The average of y</span></label><label><input type="radio" autocomplete="off" name="radio_BQZNWMRMJL" value=""> <span>The error variance</span></label><label><input type="radio" autocomplete="off" name="radio_BQZNWMRMJL" value="answer"> <span>Expected change in y for a one-unit increase in x</span></label><label><input type="radio" autocomplete="off" name="radio_BQZNWMRMJL" value=""> <span>The intercept</span></label>
</div>
<span class="mcq-key" data-correct="Expected change in y for a one-unit increase in x"></span>
<details class="hint">
<summary>
Hint
</summary>
Δy for +1 in x.
</details>
</div>
<div class="mcq-we-q">
<strong>3) In the model y = β₀ + β₁ x + ε, what does β₀ represent?</strong><br>

<div id="radio_ECQYQAQHFT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ECQYQAQHFT" value=""> <span>The slope of x</span></label><label><input type="radio" autocomplete="off" name="radio_ECQYQAQHFT" value="answer"> <span>The expected value of y when x = 0</span></label><label><input type="radio" autocomplete="off" name="radio_ECQYQAQHFT" value=""> <span>The variance of ε</span></label><label><input type="radio" autocomplete="off" name="radio_ECQYQAQHFT" value=""> <span>Correlation between x and y</span></label>
</div>
<span class="mcq-key" data-correct="The expected value of y when x = 0"></span>
<details class="hint">
<summary>
Hint
</summary>
Value of y at x = 0.
</details>
</div>
<div class="mcq-we-q">
<strong>4) A residual is defined as:</strong><br>

<div id="radio_TYOZZIOQOB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TYOZZIOQOB" value=""> <span>Predicted y minus observed y</span></label><label><input type="radio" autocomplete="off" name="radio_TYOZZIOQOB" value=""> <span>Observed x minus predicted x</span></label><label><input type="radio" autocomplete="off" name="radio_TYOZZIOQOB" value="answer"> <span>Observed y minus predicted y</span></label><label><input type="radio" autocomplete="off" name="radio_TYOZZIOQOB" value=""> <span>The fitted value</span></label>
</div>
<span class="mcq-key" data-correct="Observed y minus predicted y"></span>
<details class="hint">
<summary>
Hint
</summary>
Actual − fitted.
</details>
</div>
<div class="mcq-we-q">
<strong>5) Ordinary Least Squares (OLS) chooses coefficients to:</strong><br>

<div id="radio_FCISSQRMIO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FCISSQRMIO" value=""> <span>Maximize R²</span></label><label><input type="radio" autocomplete="off" name="radio_FCISSQRMIO" value=""> <span>Minimize the sum of absolute residuals</span></label><label><input type="radio" autocomplete="off" name="radio_FCISSQRMIO" value="answer"> <span>Minimize the sum of squared residuals</span></label><label><input type="radio" autocomplete="off" name="radio_FCISSQRMIO" value=""> <span>Maximize the likelihood under normal errors only</span></label>
</div>
<span class="mcq-key" data-correct="Minimize the sum of squared residuals"></span>
<details class="hint">
<summary>
Hint
</summary>
Squares penalize big errors more.
</details>
</div>
<div class="mcq-we-q">
<strong>6) With an intercept in the model, OLS residuals:</strong><br>

<div id="radio_FEDDJSOMKB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FEDDJSOMKB" value=""> <span>Sum to a positive number</span></label><label><input type="radio" autocomplete="off" name="radio_FEDDJSOMKB" value=""> <span>Sum to a negative number</span></label><label><input type="radio" autocomplete="off" name="radio_FEDDJSOMKB" value="answer"> <span>Sum to zero</span></label><label><input type="radio" autocomplete="off" name="radio_FEDDJSOMKB" value=""> <span>Sum to the sample mean of y</span></label>
</div>
<span class="mcq-key" data-correct="Sum to zero"></span>
<details class="hint">
<summary>
Hint
</summary>
∑eᵢ = 0 and Xᵀe = 0 when an intercept is included.
</details>
</div>
<div class="mcq-we-q">
<strong>7) In simple OLS with an intercept, the fitted line passes through…</strong><br>

<div id="radio_TKSDGIZRXF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TKSDGIZRXF" value=""> <span>The origin (0,0)</span></label><label><input type="radio" autocomplete="off" name="radio_TKSDGIZRXF" value="answer"> <span>The point (x̄, ȳ)</span></label><label><input type="radio" autocomplete="off" name="radio_TKSDGIZRXF" value=""> <span>The median of x and y</span></label><label><input type="radio" autocomplete="off" name="radio_TKSDGIZRXF" value=""> <span>The maximum of y</span></label>
</div>
<span class="mcq-key" data-correct="The point (x̄, ȳ)"></span>
<details class="hint">
<summary>
Hint
</summary>
It goes through the means.
</details>
</div>
<div class="mcq-we-q">
<strong>8) Which R function fits a simple linear regression model?</strong><br>

<div id="radio_FVPFVPSJHB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FVPFVPSJHB" value=""> <span>plot()</span></label><label><input type="radio" autocomplete="off" name="radio_FVPFVPSJHB" value=""> <span>cor()</span></label><label><input type="radio" autocomplete="off" name="radio_FVPFVPSJHB" value="answer"> <span>lm()</span></label><label><input type="radio" autocomplete="off" name="radio_FVPFVPSJHB" value=""> <span>predict()</span></label>
</div>
<p><span class="mcq-key" data-correct="lm()"></span></p>
</div>
<div class="mcq-we-q">
<strong>9) In <code>summary(mod)</code>, the p-value for the slope tests:</strong><br>

<div id="radio_SFPECDHXYW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SFPECDHXYW" value=""> <span>H₀: β₁ ≠ 0</span></label><label><input type="radio" autocomplete="off" name="radio_SFPECDHXYW" value="answer"> <span>H₀: β₁ = 0</span></label><label><input type="radio" autocomplete="off" name="radio_SFPECDHXYW" value=""> <span>H₀: β₀ = 0</span></label><label><input type="radio" autocomplete="off" name="radio_SFPECDHXYW" value=""> <span>H₀: errors are normal</span></label>
</div>
<p><span class="mcq-key" data-correct="H₀: β₁ = 0"></span></p>
</div>
<div class="mcq-we-q">
<strong>10) The p-value is best described as:</strong><br>

<div id="radio_JDOIBPVJNR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JDOIBPVJNR" value=""> <span>The probability H₁ is true</span></label><label><input type="radio" autocomplete="off" name="radio_JDOIBPVJNR" value=""> <span>The probability the estimate is correct</span></label><label><input type="radio" autocomplete="off" name="radio_JDOIBPVJNR" value="answer"> <span>The probability (under H₀) of a result at least as extreme as observed</span></label><label><input type="radio" autocomplete="off" name="radio_JDOIBPVJNR" value=""> <span>The Type II error rate</span></label>
</div>
<p><span class="mcq-key" data-correct="The probability (under H₀) of a result at least as extreme as observed"></span></p>
</div>
<div class="mcq-we-q">
<strong>11) A 95% confidence interval for β₁ is generally:</strong><br>

<div id="radio_OLOXIQQWEJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OLOXIQQWEJ" value=""> <span>Estimate ± 1.96 × σ of y</span></label><label><input type="radio" autocomplete="off" name="radio_OLOXIQQWEJ" value="answer"> <span>Estimate ± critical t × SE(β₁)</span></label><label><input type="radio" autocomplete="off" name="radio_OLOXIQQWEJ" value=""> <span>Estimate ± 2 × residual SD</span></label><label><input type="radio" autocomplete="off" name="radio_OLOXIQQWEJ" value=""> <span>SE(β₁) ± estimate</span></label>
</div>
<p><span class="mcq-key" data-correct="Estimate ± critical t × SE(β₁)"></span></p>
</div>
<div class="mcq-we-q">
<strong>12) R² measures:</strong><br>

<div id="radio_JDYYFRSXYD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_JDYYFRSXYD" value=""> <span>The correlation between x and y</span></label><label><input type="radio" autocomplete="off" name="radio_JDYYFRSXYD" value="answer"> <span>Proportion of variance in y explained by x</span></label><label><input type="radio" autocomplete="off" name="radio_JDYYFRSXYD" value=""> <span>The average residual size</span></label><label><input type="radio" autocomplete="off" name="radio_JDYYFRSXYD" value=""> <span>The probability the model is correct</span></label>
</div>
<p><span class="mcq-key" data-correct="Proportion of variance in y explained by x"></span></p>
</div>
<div class="mcq-we-q">
<strong>13) Adjusted R² differs from R² because it:</strong><br>

<div id="radio_WTIDXAMPIQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WTIDXAMPIQ" value=""> <span>Ignores sample size</span></label><label><input type="radio" autocomplete="off" name="radio_WTIDXAMPIQ" value=""> <span>Is always larger than R²</span></label><label><input type="radio" autocomplete="off" name="radio_WTIDXAMPIQ" value="answer"> <span>Penalizes adding predictors relative to sample size</span></label><label><input type="radio" autocomplete="off" name="radio_WTIDXAMPIQ" value=""> <span>Equals 1 − R²</span></label>
</div>
<p><span class="mcq-key" data-correct="Penalizes adding predictors relative to sample size"></span></p>
</div>
<div class="mcq-we-q">
<strong>14) To make a prediction at x = x₀, you use:</strong><br>

<div id="radio_UFUPOFITXG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UFUPOFITXG" value=""> <span>β₁ × x₀</span></label><label><input type="radio" autocomplete="off" name="radio_UFUPOFITXG" value=""> <span>β₀ ÷ x₀</span></label><label><input type="radio" autocomplete="off" name="radio_UFUPOFITXG" value="answer"> <span>ŷ = β₀ + β₁ × x₀</span></label><label><input type="radio" autocomplete="off" name="radio_UFUPOFITXG" value=""> <span>SE(β₁) × x₀</span></label>
</div>
<span class="mcq-key" data-correct="ŷ = β₀ + β₁ × x₀"></span>
<details class="hint">
<summary>
Hint
</summary>
Plug x₀ into the fitted line.
</details>
</div>
<div class="mcq-we-q">
<strong>15) For OLS to be unbiased, a key assumption is:</strong><br>

<div id="radio_VGJFMWZAPL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VGJFMWZAPL" value=""> <span>x is normally distributed</span></label><label><input type="radio" autocomplete="off" name="radio_VGJFMWZAPL" value=""> <span>Errors have zero variance</span></label><label><input type="radio" autocomplete="off" name="radio_VGJFMWZAPL" value="answer"> <span>E[ε | x] = 0 (errors have zero mean conditional on x)</span></label><label><input type="radio" autocomplete="off" name="radio_VGJFMWZAPL" value=""> <span>y is standardized</span></label>
</div>
<p><span class="mcq-key" data-correct="E[ε | x] = 0 (errors have zero mean conditional on x)"></span></p>
</div>
<div class="mcq-we-q">
<strong>16) Homoskedasticity means:</strong><br>

<div id="radio_ODCKHSACYX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ODCKHSACYX" value=""> <span>Errors are perfectly correlated</span></label><label><input type="radio" autocomplete="off" name="radio_ODCKHSACYX" value="answer"> <span>Variance of errors is constant across x</span></label><label><input type="radio" autocomplete="off" name="radio_ODCKHSACYX" value=""> <span>Mean of errors is zero only at x̄</span></label><label><input type="radio" autocomplete="off" name="radio_ODCKHSACYX" value=""> <span>x has constant variance</span></label>
</div>
<p><span class="mcq-key" data-correct="Variance of errors is constant across x"></span></p>
</div>
<div class="mcq-we-q">
<strong>17) In <code>summary(mod)</code>, the t value for β₁ equals:</strong><br>

<div id="radio_DVTIQUAYUT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DVTIQUAYUT" value=""> <span>β₁</span></label><label><input type="radio" autocomplete="off" name="radio_DVTIQUAYUT" value=""> <span>SE(β₁)</span></label><label><input type="radio" autocomplete="off" name="radio_DVTIQUAYUT" value="answer"> <span>Estimate(β₁) / SE(β₁)</span></label><label><input type="radio" autocomplete="off" name="radio_DVTIQUAYUT" value=""> <span>1 − p-value</span></label>
</div>
<span class="mcq-key" data-correct="Estimate(β₁) / SE(β₁)"></span>
<details class="hint">
<summary>
Hint
</summary>
Signal ÷ noise for the slope estimate.
</details>
</div>
<div class="mcq-we-q">
<strong>18) The units of β₁ are best described as:</strong><br>

<div id="radio_VMVSVGBBAV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VMVSVGBBAV" value=""> <span>Units of y</span></label><label><input type="radio" autocomplete="off" name="radio_VMVSVGBBAV" value="answer"> <span>Units of y per unit of x</span></label><label><input type="radio" autocomplete="off" name="radio_VMVSVGBBAV" value=""> <span>Unitless</span></label><label><input type="radio" autocomplete="off" name="radio_VMVSVGBBAV" value=""> <span>Units of x per unit of y</span></label>
</div>
<p><span class="mcq-key" data-correct="Units of y per unit of x"></span></p>
</div>
<div class="mcq-we-q">
<strong>19) Rescaling x from dollars to hundreds of dollars will:</strong><br>

<div id="radio_UNYTSNCJPU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_UNYTSNCJPU" value=""> <span>Leave β₁ unchanged</span></label><label><input type="radio" autocomplete="off" name="radio_UNYTSNCJPU" value="answer"> <span>Rescale β₁ numerically but leave R² and the t-test for β₁ unchanged</span></label><label><input type="radio" autocomplete="off" name="radio_UNYTSNCJPU" value=""> <span>Change the data but not the model</span></label><label><input type="radio" autocomplete="off" name="radio_UNYTSNCJPU" value=""> <span>Invalidate OLS</span></label>
</div>
<p><span class="mcq-key" data-correct="Rescale β₁ numerically but leave R² and the t-test for β₁ unchanged"></span></p>
</div>
<div class="mcq-we-q">
<strong>20) After fitting <code>mod &lt;- lm(y ~ x, d)</code>, the fitted value at x₀ is:</strong><br>

<div id="radio_TMCEDINPJD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TMCEDINPJD" value=""> <span>residuals(mod)[x==x₀]</span></label><label><input type="radio" autocomplete="off" name="radio_TMCEDINPJD" value="answer"> <span>predict(mod, newdata = data.frame(x = x₀))</span></label><label><input type="radio" autocomplete="off" name="radio_TMCEDINPJD" value=""> <span>coef(mod)['x']</span></label><label><input type="radio" autocomplete="off" name="radio_TMCEDINPJD" value=""> <span>fitted(mod)[1] always</span></label>
</div>
<span class="mcq-key" data-correct="predict(mod, newdata = data.frame(x = x₀))"></span>
<details class="hint">
<summary>
Hint
</summary>
Use <code>predict()</code> with a small data frame for x₀.
</details>
</div>
</div>
<hr>
<p>🏁 <em>End of lab 7</em> 🛑 Remember to save your script 💾</p>
<hr>
</section>
</section>
</section>
<section id="lab-8-prediction-with-the-linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="lab-8-prediction-with-the-linear-regression-model">🧪 Lab 8 — Prediction with the Linear Regression Model</h2>
<section id="learning-outcomes-1" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes-1">🎯 Learning outcomes</h3>
<p>By the end of this lab you will be able to:</p>
<ol type="1">
<li>Generate point predictions and quantify their uncertainty using R’s prediction framework</li>
<li>Distinguish between confidence intervals for average outcomes and prediction intervals for individual cases, and select the appropriate interval for applied research contexts</li>
<li>Assess the reliability of coefficient estimates through their variance-covariance structure</li>
<li>Recognize when predictions involve extrapolation beyond observed data and understand the associated risks</li>
<li>Handle non-linear relationships through quadratic and log-linear specifications</li>
</ol>
<hr>
</section>
<section id="prerequisites-1" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites-1">🧰 Prerequisites</h3>
<p><strong>Knowledge:</strong> - Understanding of simple linear regression (Lab 7) - Familiarity with residuals, fitted values, and R² - Basic probability concepts (sampling distributions, standard errors)</p>
<p><strong>Technical:</strong> - R (≥ 4.0) and RStudio installed - Completed Labs 1-7 - Required packages (install if needed):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"PoEdata"</span>)) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccolonescu/PoEdata"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Datasets:</strong></p>
<p>food - household food expenditure and income (40 observations) br - Baton Rouge house prices and characteristics (1,080 observations) —</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notation reminder: We use Greek letters (β1,β2​) for true population parameters and Latin letters (b1,b2​) for their sample estimates.</p>
<p>ŷ: predicted y value</p>
<p><span class="math inline">\(\hat{\beta}\)</span> or <span class="math inline">\(\hat{b}\)</span> are sometimes used interchangeably with b for estimates</p>
</div>
</div>
<p>In Lab 7, we learned how to estimate relationships, But estimation is only half the story. In applied research, we often need to make predictions. In applied land economics research, prediction is crucial—whether forecasting property values, estimating rental yields, or projecting land use changes. This lab equips you with the tools to make robust predictions and quantify their uncertainty. Let’s begin with the basic prediction workflow.</p>
<p>Once we have estimated our regression coefficients <span class="math inline">\(b_1\)</span> (intercept) and <span class="math inline">\(b_2\)</span> (slope), we can use them to predict food expenditure for any given income level using the fitted regression equation (Eq. 2).</p>
<p><span class="math display">\[
\hat{y} = b_1 + b_2 x \tag{2}
\]</span></p>
<p>⚠️<strong>Unit conversion:</strong> In the following R script “income = $2000” is <strong>“income = 20”</strong> (the data is in hundreds of dollars).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 1: Fit the model (recap from Lab 7)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"food"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the food expenditure model</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(food_exp <span class="sc">~</span> income, <span class="at">data =</span> food)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Review estimates</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = food_exp ~ income, data = food)

Residuals:
     Min       1Q   Median       3Q      Max 
-223.025  -50.816   -6.324   67.879  212.044 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   83.416     43.410   1.922   0.0622 .  
income        10.210      2.093   4.877 1.95e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 89.52 on 38 degrees of freedom
Multiple R-squared:  0.385, Adjusted R-squared:  0.3688 
F-statistic: 23.79 on 1 and 38 DF,  p-value: 1.946e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 2: Create a data frame with target income values</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: Predict food expenditure for three household types</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: income is in $100s, so divide actual income by 100</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>newx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">27</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 3: Generate predictions</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The predict() function takes two arguments:</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   1. A fitted model object (mod1)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   2. A data frame with new x-values (must have same column names as original data)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, newx)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Give friendly names to each prediction so the output is   easy to read</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(yhat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Low income = $2000"</span>, <span class="st">"Median income = $2500"</span>, <span class="st">"High income = $2700"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the predictions</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>yhat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Low income = $2000 Median income = $2500   High income = $2700 
             287.6089              338.6571              359.0764 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Step 4: Interpret the results</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A household earning $2,000/week is predicted to spend $287.60 on food per week.</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This represents about 14.4% of their income (287.6/2000).</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For the median household ($2,500/week), predicted food expenditure is $338.70,</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># or about 13.5% of income.</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Observation: The proportion of income spent on food decreases as income rises—</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># this is consistent with Engel's Law from economics.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>What’s Missing? Uncertainty!</strong></p>
<p>These are <strong>point predictions</strong>—our single best guess at each income level. But how confident are we?</p>
<p>Consider the household earning $2,000/week: - We predict they’ll spend $287.60 on food - But there’s sampling uncertainty (our <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> are estimates) - And individual variation (not all $2,000/week households spend exactly $287.60)</p>
<p><strong>Two types of intervals address these concerns:</strong></p>
<ol type="1">
<li><strong>Confidence intervals</strong> answer: “What’s the average food expenditure for <em>all</em> households at this income level?”</li>
<li><strong>Prediction intervals</strong> answer: “What might <em>one specific</em> household at this income level spend?”</li>
</ol>
<hr>
</section>
<section id="understanding-prediction-uncertainty-through-sampling-variability" class="level3">
<h3 class="anchored" data-anchor-id="understanding-prediction-uncertainty-through-sampling-variability">Understanding Prediction Uncertainty Through Sampling Variability</h3>
<p>Our predictions depend entirely on our estimated coefficients (<span class="math inline">\(b_1, b_2\)</span>). But these are <em>sample estimates</em>—if we collected a different dataset, we’d get different values and therefore different predictions.</p>
<p>Before making predictions, it’s important to understand that our coefficient estimates vary across samples. This matters for land economics applications: if we’re advising on property valuations, we need to know how sensitive our predictions are to sampling variation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is “sampling with replacement”?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Imagine our 40 observations are numbered balls in an urn. We draw a ball, record its data, <strong>put it back</strong>, then draw again. Some observations may appear multiple times in a bootstrap sample; others not at all. This mimics the randomness of drawing a new sample from the population.</p>
</div>
</div>
<p>The following bootstrap exercise (simulating sampling variability) demonstrates this variability by repeatedly resampling our data and re-estimating the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(food)   <span class="co"># observations</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">50</span>           <span class="co"># repeats</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">38</span>           <span class="co"># subsample size</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>sumb2 <span class="ot">&lt;-</span> <span class="dv">0</span>        <span class="co"># sum of slopes</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>C){</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span><span class="sc">*</span>i)   <span class="co"># reproducible</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw a bootstrap sample (with replacement)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  subsample <span class="ot">&lt;-</span> food[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, S, <span class="at">replace =</span> <span class="cn">TRUE</span>), ]  <span class="co"># bootstrap draw</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on this bootstrap sample</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(food_exp <span class="sc">~</span> income, <span class="at">data =</span> subsample)      </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  sumb2 <span class="ot">&lt;-</span> sumb2 <span class="sc">+</span> <span class="fu">coef</span>(mod2)[<span class="dv">2</span>]                       <span class="co"># store slope β2</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sumb2 <span class="sc">/</span> C, <span class="at">digits =</span> <span class="dv">3</span>)   <span class="co"># average slope</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>income 
  9.89 </code></pre>
</div>
</div>
<p>Compare this bootsrap average (repeated samples) witht the original OLS regression output (from <code>mod1</code>) for <span class="math inline">\(b_2\)</span>. They should be similar, confirming that OLS is unbiased.</p>
</section>
<section id="estimated-variances-and-covariance-of-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="estimated-variances-and-covariance-of-coefficients">Estimated Variances and Covariance of Coefficients</h3>
<p>The variance-covariance matrix tells us two crucial things: 1. <strong>Variances (diagonal):</strong> How much each coefficient estimate varies 2. <strong>Covariances (off-diagonal):</strong> How the estimates move together</p>
<p>This matters for prediction because uncertainty in <span class="math inline">\(\hat{y}\)</span> depends on uncertainty in <em>both</em> coefficients <em>and</em> their correlation. For land valuation models, ignoring this covariance can lead to overconfident predictions.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Common Error in Applied Work</strong> Many analysts incorrectly calculate prediction variance as just <span class="math inline">\(\text{Var}(b_1) + x_0^2 \cdot \text{Var}(b_2)\)</span>, omitting the covariance term. This can make predictions appear less precise than they actually are.</p>
</div>
</div>
<p>The following R script extracts estimated variances and covariances from the object <code>mod 1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coef variance–covariance matrix.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a 2×2 symmetric matrix:</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Top-left (1884.44): Var(b₁), variance of intercept</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Bottom-right (4.38): Var(b₂), variance of slope  </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Off-diagonals (-87.78): Cov(b₁,b₂), covariance between coefficients</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(mod1)                       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)     income
(Intercept)  1884.44226 -85.903157
income        -85.90316   4.381752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Extract individual components</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>(varb1   <span class="ot">&lt;-</span> <span class="fu">vcov</span>(mod1)[<span class="dv">1</span>, <span class="dv">1</span>])        <span class="co"># Var(B1), intercept variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1884.442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(varb2   <span class="ot">&lt;-</span> <span class="fu">vcov</span>(mod1)[<span class="dv">2</span>, <span class="dv">2</span>])        <span class="co"># Var(B2), slope variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.381752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(covb1b2 <span class="ot">&lt;-</span> <span class="fu">vcov</span>(mod1)[<span class="dv">1</span>, <span class="dv">2</span>])        <span class="co"># Cov(B1, B2), covariance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -85.90316</code></pre>
</div>
</div>
<p>Having established how to assess coefficient stability, we now turn to cases where linear relationships are insufficient to capture real-world patterns in land markets.</p>
</section>
<section id="non-linear-relationships---when-straight-lines-dont-fit" class="level3">
<h3 class="anchored" data-anchor-id="non-linear-relationships---when-straight-lines-dont-fit">Non-Linear Relationships - When Straight Lines Don’t Fit</h3>
<p>In practice, many land economic relationships are non-linear: - Property prices don’t increase linearly with size (diminishing returns to scale) - Land values may have threshold effects near transport nodes - Agricultural productivity often follows diminishing returns</p>
<p>We’ll explore two common approaches <strong>Quadratic Models</strong> and <strong>Log-Linear Models</strong>.</p>
<section id="part-a.-quadratic-model---for-u-shaped-or-inverted-u-relationships" class="level4">
<h4 class="anchored" data-anchor-id="part-a.-quadratic-model---for-u-shaped-or-inverted-u-relationships">PART A. Quadratic model - for U-shaped or inverted-U relationships</h4>
<p><span class="math display">\[
y_i = \beta_1 + \beta_2 x_i^2 + e_i.\tag{5}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)            <span class="co"># load package</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(br)                    <span class="co"># dataset</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> <span class="fu">I</span>(sqft<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> br)  <span class="co"># fit model</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod3)[<span class="dv">1</span>]        <span class="co"># intercept</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod3)[<span class="dv">2</span>]        <span class="co"># coeff on sqft^2</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>sqftx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">4000</span>, <span class="dv">6000</span>)              <span class="co"># evaluation points</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>pricex <span class="ot">&lt;-</span> b1 <span class="sc">+</span> b2 <span class="sc">*</span> sqftx<span class="sc">^</span><span class="dv">2</span>               <span class="co"># predicted price</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>DpriceDsqft <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> b2 <span class="sc">*</span> sqftx             <span class="co"># marginal effect d(price)/d(sqft)</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>elasticity <span class="ot">&lt;-</span> (DpriceDsqft <span class="sc">*</span> sqftx) <span class="sc">/</span> pricex  <span class="co"># elasticity</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>b1; b2; DpriceDsqft; elasticity           <span class="co"># output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   55776.57 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>I(sqft^2) 
0.0154213 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  61.68521 123.37041 185.05562</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.050303 1.631251 1.817408</code></pre>
</div>
</div>
<p>Plotting two alternatives for the quadratic fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mod31 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> <span class="fu">I</span>(sqft<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> br)                <span class="co"># fit</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(br<span class="sc">$</span>sqft, br<span class="sc">$</span>price, <span class="at">col =</span> <span class="st">"grey"</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Total square feet"</span>, <span class="at">ylab =</span> <span class="st">"Sale price, $"</span>) <span class="co"># scatter</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod31)                                         <span class="co"># [intercept], sqft^2</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="fu">min</span>(br<span class="sc">$</span>sqft), <span class="at">to =</span> <span class="fu">max</span>(br<span class="sc">$</span>sqft),            <span class="co"># range</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>)                               <span class="co"># fitted curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ordat <span class="ot">&lt;-</span> br[<span class="fu">order</span>(br<span class="sc">$</span>sqft), ]                             <span class="co"># sort by sqft</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mod31 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> <span class="fu">I</span>(sqft<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> ordat)              <span class="co"># fit model on sorted data</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(br<span class="sc">$</span>sqft, br<span class="sc">$</span>price, <span class="at">col =</span> <span class="st">"grey"</span>,                     <span class="co"># scatter</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Dataset ordered by 'sqft'"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Total square feet"</span>, <span class="at">ylab =</span> <span class="st">"Sale price, $"</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(mod31) <span class="sc">~</span> ordat<span class="sc">$</span>sqft)                         <span class="co"># add fitted curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-b.-log-linear-models---for-proportional-percentage-relationships" class="level4">
<h4 class="anchored" data-anchor-id="part-b.-log-linear-models---for-proportional-percentage-relationships">PART B. Log-Linear Models - for proportional (percentage) relationships</h4>
<p><span class="math display">\[
\log(y_i) = \beta_1 + \beta_2 x_i + e_i.\tag{6}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(br<span class="sc">$</span>price)                <span class="co"># price distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(br<span class="sc">$</span>price))           <span class="co"># log-price distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(price) <span class="sc">~</span> sqft, <span class="at">data =</span> br)  <span class="co"># log-linear fit</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod4)[<span class="dv">1</span>]          <span class="co"># intercept</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod4)[<span class="dv">2</span>]          <span class="co"># slope</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Back-transform fitted curve to price scale</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>ordat <span class="ot">&lt;-</span> br[<span class="fu">order</span>(br<span class="sc">$</span>sqft), ]                     <span class="co"># sort by sqft</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>mod4  <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(price) <span class="sc">~</span> sqft, <span class="at">data =</span> ordat)      <span class="co"># refit (ordered)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(br<span class="sc">$</span>sqft, br<span class="sc">$</span>price, <span class="at">col =</span> <span class="st">"grey"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Total square feet"</span>, <span class="at">ylab =</span> <span class="st">"Sale price, $"</span>)  <span class="co"># scatter</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">exp</span>(<span class="fu">fitted</span>(mod4)) <span class="sc">~</span> ordat<span class="sc">$</span>sqft, <span class="at">lwd =</span> <span class="dv">2</span>)    <span class="co"># exp of fitted log-price</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ⚠️ Important: Simply exponentiating log predictions (exp(fitted)) gives the median, not the mean. For mean predictions, apply a smearing correction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Elasticity and marginal effect at the median price:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pricex <span class="ot">&lt;-</span> <span class="fu">median</span>(br<span class="sc">$</span>price)                                   <span class="co"># target price (median)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sqftx  <span class="ot">&lt;-</span> (<span class="fu">log</span>(pricex) <span class="sc">-</span> <span class="fu">coef</span>(mod4)[<span class="dv">1</span>]) <span class="sc">/</span> <span class="fu">coef</span>(mod4)[<span class="dv">2</span>]      <span class="co"># back out sqft from log model</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>(DyDx <span class="ot">&lt;-</span> pricex <span class="sc">*</span> <span class="fu">coef</span>(mod4)[<span class="dv">2</span>])                              <span class="co"># marginal effect d(price)/d(sqft) = b2 * price</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sqft 
53.46495 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(elasticity <span class="ot">&lt;-</span> sqftx <span class="sc">*</span> <span class="fu">coef</span>(mod4)[<span class="dv">2</span>])                         <span class="co"># elasticity = (dP/dx)*(x/P) = b2 * sqft</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  0.9366934 </code></pre>
</div>
</div>
<p>Multiple points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod4)[<span class="dv">1</span>]                     <span class="co"># intercept of log(price) ~ sqft</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod4)[<span class="dv">2</span>]                     <span class="co"># slope wrt sqft</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>sqftx  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">3000</span>, <span class="dv">4000</span>)           <span class="co"># sqft points</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>pricex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100000</span>, <span class="fu">exp</span>(b1 <span class="sc">+</span> b2<span class="sc">*</span>sqftx)) <span class="co"># prices: first fixed at 100k; others from model</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>sqftx  <span class="ot">&lt;-</span> (<span class="fu">log</span>(pricex) <span class="sc">-</span> b1) <span class="sc">/</span> b2       <span class="co"># implied sqft from each price (now length = length(pricex))</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>(elasticities <span class="ot">&lt;-</span> b2 <span class="sc">*</span> sqftx)            <span class="co"># elasticity = (dP/dx)*(x/P) = b2 * sqft</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6743291 0.8225377 1.2338066 1.6450754</code></pre>
</div>
</div>
<p>💡 <strong>Land Economics Application</strong> In rental valuation, we rarely observe rental income for vacant plots. Prediction intervals help quantify the uncertainty in forecasted rents, which is crucial for development feasibility analysis.</p>
<p>⚠️ <strong>Common Mistake</strong> Students often confuse confidence intervals (for the average) with prediction intervals (for individuals). In property valuation, this distinction matters: are you estimating the average price for houses of this type, or the likely sale price of one specific house?</p>
</section>
<section id="part-c.-mcqs-1" class="level4">
<h4 class="anchored" data-anchor-id="part-c.-mcqs-1">PART C. MCQs</h4>
<div class="mcq-we">
<div class="mcq-we-q">
<strong>1) Using B₀ and B₁ primarily helps to:</strong><br>

<div id="radio_WPGHGLJCCK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WPGHGLJCCK" value=""> <span>Test normality of residuals</span></label><label><input type="radio" autocomplete="off" name="radio_WPGHGLJCCK" value=""> <span>Estimate σ²</span></label><label><input type="radio" autocomplete="off" name="radio_WPGHGLJCCK" value="answer"> <span>Predict E[y|x]</span></label><label><input type="radio" autocomplete="off" name="radio_WPGHGLJCCK" value=""> <span>Standardize x and y</span></label>
</div>
<span class="mcq-key" data-correct="Predict E[y|x]"></span>
<details class="hint">
<summary>
Hint
</summary>
Plug x into the fitted line.
</details>
</div>
<div class="mcq-we-q">
<strong>2) The function lm() is used to:</strong><br>

<div id="radio_ZNFURPXKLP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZNFURPXKLP" value=""> <span>Simulate data</span></label><label><input type="radio" autocomplete="off" name="radio_ZNFURPXKLP" value=""> <span>Draw histograms</span></label><label><input type="radio" autocomplete="off" name="radio_ZNFURPXKLP" value="answer"> <span>Estimate a linear model</span></label><label><input type="radio" autocomplete="off" name="radio_ZNFURPXKLP" value=""> <span>Compute correlation only</span></label>
</div>
<span class="mcq-key" data-correct="Estimate a linear model"></span>
<details class="hint">
<summary>
Hint
</summary>
It returns coefficients and a model object.
</details>
</div>
<div class="mcq-we-q">
<strong>3) The function predict() mainly:</strong><br>

<div id="radio_VNINESMRUF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_VNINESMRUF" value=""> <span>Fits a model</span></label><label><input type="radio" autocomplete="off" name="radio_VNINESMRUF" value=""> <span>Computes residuals only</span></label><label><input type="radio" autocomplete="off" name="radio_VNINESMRUF" value="answer"> <span>Estimates y-hat for new data</span></label><label><input type="radio" autocomplete="off" name="radio_VNINESMRUF" value=""> <span>Sorts a data frame</span></label>
</div>
<span class="mcq-key" data-correct="Estimates y-hat for new data"></span>
<details class="hint">
<summary>
Hint
</summary>
You pass newdata.
</details>
</div>
<div class="mcq-we-q">
<strong>4) Coefficients are random because they:</strong><br>

<div id="radio_FNIMCAIYSF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FNIMCAIYSF" value=""> <span>Depend only on fixed formulas</span></label><label><input type="radio" autocomplete="off" name="radio_FNIMCAIYSF" value=""> <span>Are set by the user</span></label><label><input type="radio" autocomplete="off" name="radio_FNIMCAIYSF" value="answer"> <span>Depend on the sample</span></label><label><input type="radio" autocomplete="off" name="radio_FNIMCAIYSF" value=""> <span>Don’t change across samples</span></label>
</div>
<p><span class="mcq-key" data-correct="Depend on the sample"></span></p>
</div>
<div class="mcq-we-q">
<strong>5) Random subsamples help to:</strong><br>

<div id="radio_HYYXPJZNCZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HYYXPJZNCZ" value=""> <span>Reduce file size</span></label><label><input type="radio" autocomplete="off" name="radio_HYYXPJZNCZ" value=""> <span>Guarantee higher R²</span></label><label><input type="radio" autocomplete="off" name="radio_HYYXPJZNCZ" value="answer"> <span>Evaluate stability/variability</span></label><label><input type="radio" autocomplete="off" name="radio_HYYXPJZNCZ" value=""> <span>Eliminate outliers always</span></label>
</div>
<p><span class="mcq-key" data-correct="Evaluate stability/variability"></span></p>
</div>
<div class="mcq-we-q">
<strong>6) vcov(model) returns:</strong><br>

<div id="radio_PSSTXEYBCI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PSSTXEYBCI" value=""> <span>Residuals</span></label><label><input type="radio" autocomplete="off" name="radio_PSSTXEYBCI" value=""> <span>Fitted values</span></label><label><input type="radio" autocomplete="off" name="radio_PSSTXEYBCI" value="answer"> <span>Variances and covariances of coefficients</span></label><label><input type="radio" autocomplete="off" name="radio_PSSTXEYBCI" value=""> <span>Confidence intervals for y-hat</span></label>
</div>
<p><span class="mcq-key" data-correct="Variances and covariances of coefficients"></span></p>
</div>
<div class="mcq-we-q">
<strong>7) Using data.frame() with predict() is to:</strong><br>

<div id="radio_RXDDNJOIJN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RXDDNJOIJN" value="answer"> <span>Provide new x values with correct column names</span></label><label><input type="radio" autocomplete="off" name="radio_RXDDNJOIJN" value=""> <span>Shuffle the rows</span></label><label><input type="radio" autocomplete="off" name="radio_RXDDNJOIJN" value=""> <span>Change variable types to character</span></label><label><input type="radio" autocomplete="off" name="radio_RXDDNJOIJN" value=""> <span>Compute R²</span></label>
</div>
<p><span class="mcq-key" data-correct="Provide new x values with correct column names"></span></p>
</div>
<div class="mcq-we-q">
<strong>8) To request standard errors from predict.lm you set:</strong><br>

<div id="radio_MQNTZAJYZT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MQNTZAJYZT" value=""> <span>stderr = TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_MQNTZAJYZT" value=""> <span>se = TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_MQNTZAJYZT" value="answer"> <span>se.fit = TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_MQNTZAJYZT" value=""> <span>ci = TRUE</span></label>
</div>
<span class="mcq-key" data-correct="se.fit = TRUE"></span>
<details class="hint">
<summary>
Hint
</summary>
It returns fit and se.fit.
</details>
</div>
<div class="mcq-we-q">
<strong>9) For a confidence interval for the mean response at x₀, use:</strong><br>

<div id="radio_FTMLTBLYUG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FTMLTBLYUG" value=""> <span>interval = 'pi'</span></label><label><input type="radio" autocomplete="off" name="radio_FTMLTBLYUG" value=""> <span>bands = 'mean'</span></label><label><input type="radio" autocomplete="off" name="radio_FTMLTBLYUG" value="answer"> <span>interval = 'confidence'</span></label><label><input type="radio" autocomplete="off" name="radio_FTMLTBLYUG" value=""> <span>type = 'mean'</span></label>
</div>
<span class="mcq-key" data-correct="interval = 'confidence'"></span>
<details class="hint">
<summary>
Hint
</summary>
CI for E[y|x₀].
</details>
</div>
<div class="mcq-we-q">
<strong>10) For an interval predicting an individual future y at x₀, use:</strong><br>

<div id="radio_NZHIDGZHHQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NZHIDGZHHQ" value=""> <span>interval = 'confidence'</span></label><label><input type="radio" autocomplete="off" name="radio_NZHIDGZHHQ" value="answer"> <span>interval = 'prediction'</span></label><label><input type="radio" autocomplete="off" name="radio_NZHIDGZHHQ" value=""> <span>level = 'future'</span></label><label><input type="radio" autocomplete="off" name="radio_NZHIDGZHHQ" value=""> <span>type = 'response'</span></label>
</div>
<span class="mcq-key" data-correct="interval = 'prediction'"></span>
<details class="hint">
<summary>
Hint
</summary>
Includes error variance.
</details>
</div>
<div class="mcq-we-q">
<strong>11) Prediction intervals are typically:</strong><br>

<div id="radio_WHPQKTCCPA" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WHPQKTCCPA" value=""> <span>Narrower than confidence intervals</span></label><label><input type="radio" autocomplete="off" name="radio_WHPQKTCCPA" value="answer"> <span>Wider than confidence intervals</span></label><label><input type="radio" autocomplete="off" name="radio_WHPQKTCCPA" value=""> <span>Identical to confidence intervals</span></label><label><input type="radio" autocomplete="off" name="radio_WHPQKTCCPA" value=""> <span>Unrelated to residual variance</span></label>
</div>
<p><span class="mcq-key" data-correct="Wider than confidence intervals"></span></p>
</div>
<div class="mcq-we-q">
<strong>12) confint(model) returns:</strong><br>

<div id="radio_RPLEGRMQXV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RPLEGRMQXV" value=""> <span>Intervals for y-hat</span></label><label><input type="radio" autocomplete="off" name="radio_RPLEGRMQXV" value="answer"> <span>Confidence intervals for coefficients</span></label><label><input type="radio" autocomplete="off" name="radio_RPLEGRMQXV" value=""> <span>Prediction intervals for new y</span></label><label><input type="radio" autocomplete="off" name="radio_RPLEGRMQXV" value=""> <span>Variance of residuals</span></label>
</div>
<p><span class="mcq-key" data-correct="Confidence intervals for coefficients"></span></p>
</div>
<div class="mcq-we-q">
<strong>13) For models with multiple predictors, newdata must:</strong><br>

<div id="radio_PGIACUQWQY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PGIACUQWQY" value="answer"> <span>Contain columns matching model terms and types</span></label><label><input type="radio" autocomplete="off" name="radio_PGIACUQWQY" value=""> <span>Be a vector in any order</span></label><label><input type="radio" autocomplete="off" name="radio_PGIACUQWQY" value=""> <span>Include only the response</span></label><label><input type="radio" autocomplete="off" name="radio_PGIACUQWQY" value=""> <span>Be sorted by the response</span></label>
</div>
<span class="mcq-key" data-correct="Contain columns matching model terms and types"></span>
<details class="hint">
<summary>
Hint
</summary>
Names must match the formula’s variables.
</details>
</div>
<div class="mcq-we-q">
<strong>14) In a log-linear model log(y) ~ x, to back-transform the mean prediction you should:</strong><br>

<div id="radio_ILMUPAUCFP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ILMUPAUCFP" value=""> <span>Use only exp(eta)</span></label><label><input type="radio" autocomplete="off" name="radio_ILMUPAUCFP" value="answer"> <span>Multiply exp(eta) by a smearing factor</span></label><label><input type="radio" autocomplete="off" name="radio_ILMUPAUCFP" value=""> <span>Square the fitted values</span></label><label><input type="radio" autocomplete="off" name="radio_ILMUPAUCFP" value=""> <span>Add residual SD then exponentiate</span></label>
</div>
<span class="mcq-key" data-correct="Multiply exp(eta) by a smearing factor"></span>
<details class="hint">
<summary>
Hint
</summary>
Duan’s correction: mean(exp(ε̂)).
</details>
</div>
<div class="mcq-we-q">
<strong>15) A bootstrap (or resampling with replacement) in R uses:</strong><br>

<div id="radio_ARJRUZLMTD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ARJRUZLMTD" value=""> <span>sample(x, replace = FALSE)</span></label><label><input type="radio" autocomplete="off" name="radio_ARJRUZLMTD" value="answer"> <span>sample(x, replace = TRUE)</span></label><label><input type="radio" autocomplete="off" name="radio_ARJRUZLMTD" value=""> <span>sort(x)</span></label><label><input type="radio" autocomplete="off" name="radio_ARJRUZLMTD" value=""> <span>order(x)</span></label>
</div>
<p><span class="mcq-key" data-correct="sample(x, replace = TRUE)"></span></p>
</div>
<div class="mcq-we-q">
<strong>16) set.seed(123) is used to:</strong><br>

<div id="radio_CLNLZIHFPL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CLNLZIHFPL" value=""> <span>Speed up lm()</span></label><label><input type="radio" autocomplete="off" name="radio_CLNLZIHFPL" value=""> <span>Normalize variables</span></label><label><input type="radio" autocomplete="off" name="radio_CLNLZIHFPL" value="answer"> <span>Make random subsamples reproducible</span></label><label><input type="radio" autocomplete="off" name="radio_CLNLZIHFPL" value=""> <span>Center predictors</span></label>
</div>
<p><span class="mcq-key" data-correct="Make random subsamples reproducible"></span></p>
</div>
<div class="mcq-we-q">
<strong>17) For out-of-sample performance, a good metric is:</strong><br>

<div id="radio_ICGDIAQARW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ICGDIAQARW" value=""> <span>Training R²</span></label><label><input type="radio" autocomplete="off" name="radio_ICGDIAQARW" value="answer"> <span>Test RMSE</span></label><label><input type="radio" autocomplete="off" name="radio_ICGDIAQARW" value=""> <span>Number of predictors</span></label><label><input type="radio" autocomplete="off" name="radio_ICGDIAQARW" value=""> <span>Intercept size</span></label>
</div>
<span class="mcq-key" data-correct="Test RMSE"></span>
<details class="hint">
<summary>
Hint
</summary>
Evaluate on held-out data.
</details>
</div>
<div class="mcq-we-q">
<strong>18) Extrapolation risk means:</strong><br>

<div id="radio_KGZOKZFIFN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KGZOKZFIFN" value=""> <span>Predictions are always unbiased</span></label><label><input type="radio" autocomplete="off" name="radio_KGZOKZFIFN" value="answer"> <span>x₀ lies outside the observed x range so predictions can be unreliable</span></label><label><input type="radio" autocomplete="off" name="radio_KGZOKZFIFN" value=""> <span>R² increases automatically</span></label><label><input type="radio" autocomplete="off" name="radio_KGZOKZFIFN" value=""> <span>CI and PI become identical</span></label>
</div>
<p><span class="mcq-key" data-correct="x₀ lies outside the observed x range so predictions can be unreliable"></span></p>
</div>
<div class="mcq-we-q">
<strong>19) Variance of the predicted mean at x₀ depends on:</strong><br>

<div id="radio_HCWMTQQENZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HCWMTQQENZ" value=""> <span>Only σ²</span></label><label><input type="radio" autocomplete="off" name="radio_HCWMTQQENZ" value=""> <span>Only the intercept</span></label><label><input type="radio" autocomplete="off" name="radio_HCWMTQQENZ" value="answer"> <span>x₀ᵀ Var(B̂) x₀</span></label><label><input type="radio" autocomplete="off" name="radio_HCWMTQQENZ" value=""> <span>Only sample size</span></label>
</div>
<span class="mcq-key" data-correct="x₀ᵀ Var(B̂) x₀"></span>
<details class="hint">
<summary>
Hint
</summary>
Use the variance–covariance of coefficients.
</details>
</div>
<div class="mcq-we-q">
<strong>20) When predicting with factors, newdata must:</strong><br>

<div id="radio_CROAHKCLEC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_CROAHKCLEC" value="answer"> <span>Use levels seen in the training data</span></label><label><input type="radio" autocomplete="off" name="radio_CROAHKCLEC" value=""> <span>Introduce new unseen levels freely</span></label><label><input type="radio" autocomplete="off" name="radio_CROAHKCLEC" value=""> <span>Coerce factors to numeric</span></label><label><input type="radio" autocomplete="off" name="radio_CROAHKCLEC" value=""> <span>Omit the factor columns</span></label>
</div>
<span class="mcq-key" data-correct="Use levels seen in the training data"></span>
<details class="hint">
<summary>
Hint
</summary>
Unseen levels cause errors in predict().
</details>
</div>
</div>
<hr>
<p>🏁 <em>End of lab 8</em> 🛑 Remember to save your script 💾</p>
<hr>
</section>
</section>
</section>
<section id="lab-9-hypothesis-test-pvalue-testing-linear-combinations" class="level2">
<h2 class="anchored" data-anchor-id="lab-9-hypothesis-test-pvalue-testing-linear-combinations">🧪 Lab 9 — Hypothesis Test, p‑Value &amp; Testing Linear Combinations</h2>
<section id="learning-outcomes-2" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes-2">🎯 Learning Outcomes</h3>
<p>By the end of this lab you will be able to:</p>
<ul>
<li>Formulate null and alternative hypotheses for regression coefficients</li>
<li>Compute test statistics and compare them to critical values</li>
<li>Calculate and interpret p-values for one-tailed and two-tailed tests</li>
<li>Understand the relationship between confidence intervals and hypothesis tests</li>
<li>Test linear combinations of parameters (e.g., predictions at specific x values)</li>
<li>Apply hypothesis testing to real-world land economics questions</li>
</ul>
</section>
<section id="hypothesis-tests" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-tests">Hypothesis Tests</h3>
<p>🧰 Prerequisites Knowledge:</p>
<p>Understanding of simple linear regression (Lab 7) Familiarity with coefficient estimates and standard errors (Lab 8) Basic understanding of statistical inference (confidence intervals, significance levels)</p>
<p>Technical:</p>
<p>R (≥ 4.0) and RStudio installed Completed Labs 1-8 Required packages:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"remotes"</span>, <span class="st">"PoEdata"</span>)) </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccolonescu/PoEdata"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="introduction-why-hypothesis-testing-matters" class="level3">
<h3 class="anchored" data-anchor-id="introduction-why-hypothesis-testing-matters">Introduction: Why Hypothesis Testing Matters</h3>
<p>In Lab 7, we estimated relationships. In Lab 8, we made predictions. But how do we know if our findings are statistically meaningful? Consider our food expenditure model:</p>
<p>We estimated that food spending increases by $10.21 for every $100 increase in income But is this effect real, or could it be due to random chance? Could the true effect actually be zero (no relationship)?</p>
<p>Hypothesis testing provides a formal framework to answer these questions.</p>
<p>💡 Land Economics Application When valuing agricultural land, we might find that proximity to roads increases land value by £500 per meter. But before advising clients, we need to know: Is this effect statistically significant, or could it be sampling noise?</p>
<section id="part-a---hypothesis-tests-for-individual-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="part-a---hypothesis-tests-for-individual-coefficients">PART A - Hypothesis Tests for Individual Coefficients</h4>
<p>We start with two competing claims: <span class="math display">\[
H_0: \beta_k = c, \qquad H_A: \beta_k \ne c.
\]</span></p>
<p><strong>Test statistic:</strong></p>
<p>Under the null hypothesis, the test statistic follows a t-distribution: <span class="math display">\[
t = \frac{b_k - c}{\operatorname{se}(b_k)},\quad t \sim t_{N-2}.\tag{6}
\]</span></p>
<p>where:</p>
<p><span class="math inline">\(b_k\)</span>​ is our estimated coefficient</p>
<p><span class="math inline">\(c\)</span> is the hypothesized value (zero in our case)</p>
<p><span class="math inline">\(\operatorname{se}(b_k)\)</span> is the standard error of <span class="math inline">\(b_k\)</span></p>
<p><span class="math inline">\(N−K\)</span> is degrees of freedom (N observations, K parameters)</p>
<p><strong>Intuition:</strong> This ratio measures how many standard errors our estimate is away from the hypothesized value.</p>
<p><strong>Example 1:</strong> Two-Tailed Test (Is there any effect?) <strong>Question:</strong> Does income affect food expenditure? (i.e., is <span class="math inline">\(β2≠0\)</span>?)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set significance level</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data and estimate model</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PoEdata); <span class="fu">library</span>(xtable); <span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'xtable' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'knitr' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"food"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(food_exp <span class="sc">~</span> income, <span class="at">data=</span>food)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>smod1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod1)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression output</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">xtable</span>(mod1))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table, <span class="at">caption=</span><span class="st">"Regression output showing the coefficients"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Regression output showing the coefficients</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std..Error</th>
<th style="text-align: right;">t.value</th>
<th style="text-align: right;">Pr…t..</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">83.41600</td>
<td style="text-align: right;">43.410163</td>
<td style="text-align: right;">1.921578</td>
<td style="text-align: right;">0.0621824</td>
</tr>
<tr class="even">
<td style="text-align: left;">income</td>
<td style="text-align: right;">10.20964</td>
<td style="text-align: right;">2.093263</td>
<td style="text-align: right;">4.877381</td>
<td style="text-align: right;">0.0000195</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficient and standard error</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod1)[[<span class="st">"income"</span>]]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>seb2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">vcov</span>(mod1)[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>df  <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(mod1)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test statistic</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>t   <span class="ot">&lt;-</span> b2<span class="sc">/</span>seb2</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find critical value for two-tailed test</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>tcr <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, df)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>t; tcr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.877381</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.024394</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: 4.877 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Critical value (±):"</span>, <span class="fu">round</span>(tcr, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Critical value (±): 2.024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision:"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(t) <span class="sc">&gt;</span> tcr, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision: Reject H0 </code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Our test statistic is r round(t, 2), which is much larger than the critical value ±r round(tcr, 2)</p></li>
<li><p>We reject the null hypothesis</p></li>
<li><p>There is strong evidence that income affects food expenditure</p></li>
<li><p>Right‑tail and left‑tail versions:</p></li>
</ul>
<p><strong>Optional:</strong> 📊 Visualizing the Test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization of t-distribution and test</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, df), <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">5</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Two-Tailed Hypothesis Test"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"t-value"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade rejection regions</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span>tcr, <span class="fl">0.01</span>), <span class="sc">-</span>tcr),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span>tcr, <span class="fl">0.01</span>), df), <span class="dv">0</span>),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">density =</span> <span class="dv">20</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(tcr, <span class="fu">seq</span>(tcr, <span class="dv">4</span>, <span class="fl">0.01</span>), <span class="dv">4</span>),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dt</span>(<span class="fu">seq</span>(tcr, <span class="dv">4</span>, <span class="fl">0.01</span>), df), <span class="dv">0</span>),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">density =</span> <span class="dv">20</span>)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark critical values and test statistic</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="sc">-</span>tcr, tcr), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> t, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Rejection region (α/2 each)"</span>, </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Critical values"</span>, </span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Test statistic"</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Example 2:</strong> One-Tailed Tests Sometimes we have a directional hypothesis based on economic theory. <strong>Right-Tailed Test:</strong> Is the effect of income on food expenditure greater than $5.50?</p>
<p><span class="math display">\[
H_0: \beta_2 ≤ 5.5, \qquad H_A: \beta_2 &gt; 5.5.
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesized value</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fl">5.5</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test statistic</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>t_right <span class="ot">&lt;-</span> (b2 <span class="sc">-</span> c)<span class="sc">/</span>seb2</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Critical value (right tail only)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>tcr_right <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha, df)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t_right, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: 2.25 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Critical value:"</span>, <span class="fu">round</span>(tcr_right, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Critical value: 1.686 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision:"</span>, <span class="fu">ifelse</span>(t_right <span class="sc">&gt;</span> tcr_right, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision: Reject H0 </code></pre>
</div>
</div>
<p><strong>Left-Tailed Test:</strong> Is the effect of income on food expenditure less than $15?</p>
<p><span class="math display">\[
H_0: \beta_2 ≥ 15, \qquad H_A: \beta_2 &lt; 15.
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left-tail: H0: beta2 &gt;= 15; HA: beta2 &lt; 15</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>t_left <span class="ot">&lt;-</span> (b2 <span class="sc">-</span> c)<span class="sc">/</span>seb2</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>tcr_left <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha, df)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">t_right=</span>t_right, <span class="at">tcr_right=</span>tcr_right, <span class="at">t_left=</span>t_left, <span class="at">tcr_left=</span>tcr_left)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  t_right tcr_right    t_left  tcr_left 
 2.249904  1.685954 -2.288463 -1.685954 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t_left, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: -2.288 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Critical value:"</span>, <span class="fu">round</span>(tcr_left, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Critical value: -1.686 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision:"</span>, <span class="fu">ifelse</span>(t_left <span class="sc">&lt;</span> tcr_left, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision: Reject H0 </code></pre>
</div>
</div>
<p>⚠️ <strong>Common Mistake:</strong> Students often confuse the direction of the inequality in <span class="math inline">\(H_0\)</span>​ and <span class="math inline">\(H_A\)</span>. Remember: the alternative hypothesis represents what you’re trying to find evidence <em>for</em>.</p>
<hr>
</section>
<section id="part-b---the-pvalue-approach" class="level4">
<h4 class="anchored" data-anchor-id="part-b---the-pvalue-approach">PART B - The p‑Value Approach</h4>
<p>The p-value represents the probability of observing a t-statistic as extreme as, or more extreme than, the one obtained from the sample, assuming the null hypothesis is true. In other words, it measures how compatible the data are with the null hypothesis. We reject the null hypothesis when the p-value is smaller than the chosen significance level (e.g., 0.05).</p>
<p>For a right-tailed test, the p-value corresponds to the area to the right of the calculated t-statistic. For a left-tailed test, it is the area to the left of the calculated t-statistic. For a two-tailed test, the total p-value is divided equally between both tails—p/2 in the left tail and p/2 in the right tail.</p>
<p>In R, p-values are obtained using the function pt(t, df), where t is the calculated t-ratio and df is the model’s degrees of freedom. For two-tailed tests, the result should be adjusted to account for both tails, typically using 2*(1 - pt(abs(t), df)).</p>
<p><em>Decision rule:</em> Reject <span class="math inline">\(H_0\)</span>​ if <span class="math inline">\(p-value&lt;αp\)</span> Fail to reject <span class="math inline">\(H_0\)</span>​ if <span class="math inline">\(p-value≥αp\)</span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Common Significance Levels
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>α = 0.05</strong> (most common): We’re willing to accept a 5% chance of incorrectly rejecting H₀</li>
<li><strong>α = 0.01</strong> (more conservative): Only 1% chance of Type I error</li>
<li><strong>α = 0.10</strong> (more lenient): Accept 10% chance of error</li>
</ul>
<p><strong>The smaller the p-value, the stronger the evidence against H₀</strong></p>
</div>
</div>
<p><strong>Computing p-Values:</strong> <span class="math inline">\(F_t\)</span> stands for the cumulative distribution function (CDF) of the t-distribution.</p>
<p>Right‑tail: <span class="math inline">\(p = 1 - F_t(t)\)</span> (probability in the upper tail)</p>
<p>Left‑tail: <span class="math inline">\(p = F_t(t)\)</span> (probability in the lower tail)</p>
<p>Two‑tail: <span class="math inline">\(p = 2 * (1-F_t(|t|)\)</span> (probability in both tails)</p>
<p><strong>Example 1: Right-Tail Test</strong> <strong>Question:</strong> Is the marginal effect of income on food expenditure <em>greater than</em> $5.50?</p>
<p><span class="math display">\[H_0: \beta_2 \leq 5.5 \quad \text{vs} \quad H_A: \beta_2 &gt; 5.5\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-tail test (H0: β2 ≤ 5.5)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fl">5.5</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (b2<span class="sc">-</span>c)<span class="sc">/</span>seb2</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>p_right <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(t, df)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== RIGHT-TAIL TEST ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== RIGHT-TAIL TEST ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"H0: β2 ≤"</span>, c, <span class="st">"  (effect is at most $5.50)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>H0: β2 ≤ 5.5   (effect is at most $5.50)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"HA: β2 &gt;"</span>, c, <span class="st">"  (effect exceeds $5.50)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HA: β2 &gt; 5.5   (effect exceeds $5.50)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: 2.25 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">round</span>(p_right, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.0152 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision at α=0.05:"</span>, <span class="fu">ifelse</span>(p_right <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"✓ REJECT H0"</span>, <span class="st">"✗ FAIL TO REJECT H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision at α=0.05: ✓ REJECT H0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:"</span>, <span class="fu">ifelse</span>(p_right <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Strong evidence that β2 &gt; 5.5 (the effect exceeds $5.50)"</span>, <span class="st">"Insufficient evidence that β2 &gt; 5.5"</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation: Strong evidence that β2 &gt; 5.5 (the effect exceeds $5.50) </code></pre>
</div>
</div>
<p><strong>Example 2: Left-Tail Test</strong></p>
<p><strong>Question:</strong> Is the marginal effect of income on food expenditure <em>less than</em> $15?</p>
<p><span class="math display">\[H_0: \beta_2 \geq 15 \quad \text{vs} \quad H_A: \beta_2 &lt; 15\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left-tail test (H0: β2 ≥ 15)</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (b2<span class="sc">-</span>c)<span class="sc">/</span>seb2</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>p_left <span class="ot">&lt;-</span> <span class="fu">pt</span>(t, df)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== LEFT-TAIL TEST ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== LEFT-TAIL TEST ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"H0: β2 ≥"</span>, c, <span class="st">"  (effect is at least $15)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>H0: β2 ≥ 15   (effect is at least $15)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"HA: β2 &lt;"</span>, c, <span class="st">"  (effect is below $15)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HA: β2 &lt; 15   (effect is below $15)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: -2.288 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">round</span>(p_left, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.0139 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision at α=0.05:"</span>, <span class="fu">ifelse</span>(p_left <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"✓ REJECT H0"</span>, <span class="st">"✗ FAIL TO REJECT H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision at α=0.05: ✓ REJECT H0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:"</span>, </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(p_left <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Strong evidence that β2 &lt; 15 (the effect is below $15)"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Insufficient evidence that β2 &lt; 15"</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation: Strong evidence that β2 &lt; 15 (the effect is below $15) </code></pre>
</div>
</div>
<p><strong>Example 3: Two-Tail Test (Most Common)</strong></p>
<p><strong>Question:</strong> Is there <em>any</em> relationship between income and food expenditure?</p>
<p><span class="math display">\[H_0: \beta_2 = 0 \quad \text{vs} \quad H_A: \beta_2 \neq 0\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-tail test (H0: β2 = 0)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (b2<span class="sc">-</span>c)<span class="sc">/</span>seb2</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>p_two <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t), df))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== TWO-TAIL TEST ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== TWO-TAIL TEST ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"H0: β2 = 0  (no relationship)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>H0: β2 = 0  (no relationship)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"HA: β2 ≠ 0  (income affects food expenditure)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HA: β2 ≠ 0  (income affects food expenditure)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test statistic:"</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test statistic: 4.877 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format.pval</span>(p_two, <span class="at">digits =</span> <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 1.946e-05 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision at α=0.05:"</span>, <span class="fu">ifelse</span>(p_two <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"✓ REJECT H0"</span>, <span class="st">"✗ FAIL TO REJECT H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Decision at α=0.05: ✓ REJECT H0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:"</span>, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(p_two <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Strong evidence of a relationship between income and food expenditure"</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Insufficient evidence of a relationship"</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation: Strong evidence of a relationship between income and food expenditure </code></pre>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary of All Three Tests
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<pre class="text cell-code"><code>SUMMARY TABLE
═══════════════════════════════════════════════════════
Test Type        | H0          | p-value | Decision
─────────────────┼─────────────┼─────────┼───────────
Right-tail (&gt;)   | β2 ≤ 5.5    | %.4f    | if p_right &lt; 0.05, "REJECT"
Left-tail (&lt;)    | β2 ≥ 15     | %.4f    | if p_left &lt; 0.05, "REJECT"
Two-tail (≠)     | β2 = 0      | %.4f    | if p_two &lt; 0.05, "REJECT"
═══════════════════════════════════════════════════════</code></pre>
</div>
</div>
</div>
<p>💡 Interpretation Guide:</p>
<p><span class="math inline">\(p &lt; 0.01\)</span>: Very strong evidence against <span class="math inline">\(H_0\)</span></p>
<p>​ <span class="math inline">\(0.01 ≤ p &lt; 0.05\)</span>: Strong evidence against <span class="math inline">\(H_0\)</span></p>
<p>​ <span class="math inline">\(0.05 ≤ p &lt; 0.10\)</span>: Weak evidence against <span class="math inline">\(H_0\)</span></p>
<p>​ <span class="math inline">\(p ≥ 0.10\)</span>: Insufficient evidence against <span class="math inline">\(H_0\)</span></p>
<p>⚠️ <strong>Common Student Mistakes to Avoid:</strong></p>
<ol type="1">
<li><strong>“p-value is the probability that H₀ is true”</strong> → ❌ WRONG!
<ul>
<li>Correct: p-value is the probability of getting our data <em>if</em> H₀ were true</li>
</ul></li>
<li><strong>“Fail to reject H₀ means H₀ is true”</strong> → ❌ WRONG!
<ul>
<li>Correct: We simply don’t have enough evidence to reject it</li>
</ul></li>
<li><strong>“Reject H₀ means HA is proven true”</strong> → ❌ WRONG!
<ul>
<li>Correct: We have strong evidence <em>against</em> H₀, supporting HA</li>
</ul></li>
<li><strong>Confusing the direction in one-tailed tests</strong> → Common error!
<ul>
<li>Right-tail: Testing if parameter is <em>greater than</em> c</li>
<li>Left-tail: Testing if parameter is <em>less than</em> c</li>
</ul></li>
</ol>
</section>
<section id="part-c---testing-linear-combinations-of-parameters" class="level4">
<h4 class="anchored" data-anchor-id="part-c---testing-linear-combinations-of-parameters">PART C - Testing Linear Combinations of Parameters</h4>
<p>We want to test hypotheses about combinations of parameters, not individual coefficients.<strong>Example:</strong> What is the expected food expenditure for a household earning $2,000/week (income = 20 in our units)?</p>
<p><span class="math display">\[
L = E(\text{food\_exp}\mid \text{income}=20) = \beta_1 + 20\,\beta_2
\]</span></p>
<p>Variance identities:</p>
<p><span class="math display">\[
\operatorname{var}(aX+bY) = a^2\,\operatorname{var}(X) + b^2\,\operatorname{var}(Y) + 2ab\,\operatorname{cov}(X,Y)
\]</span></p>
<p><span class="math display">\[
\operatorname{var}(b_1+20b_2) = \operatorname{var}(b_1) + 20^2\operatorname{var}(b_2) + 2\cdot20\operatorname{cov}(b_1,b_2)
\]</span></p>
<p>⚠️ Critical Point: Many students forget the covariance term! Omitting it leads to incorrect standard errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Significance level and x-value of interest</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the model</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(food_exp <span class="sc">~</span> income, <span class="at">data=</span>food)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients and variance-covariance matrix</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> m1<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> m1<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>varb1 <span class="ot">&lt;-</span> <span class="fu">vcov</span>(m1)[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>varb2 <span class="ot">&lt;-</span> <span class="fu">vcov</span>(m1)[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>covb1b2 <span class="ot">&lt;-</span> <span class="fu">vcov</span>(m1)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the linear combination and its variance</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> b1 <span class="sc">+</span> b2<span class="sc">*</span>x</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>varL <span class="ot">&lt;-</span> varb1 <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> varb2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>x<span class="sc">*</span>covb1b2</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>seL <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(varL)</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval for L</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(m1)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>tcr <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, df)</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>lowbL <span class="ot">&lt;-</span> L <span class="sc">-</span> tcr<span class="sc">*</span>seL; upbL <span class="ot">&lt;-</span> L <span class="sc">+</span> tcr<span class="sc">*</span>seL</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">L=</span>L, <span class="at">seL=</span>seL, <span class="at">low=</span>lowbL, <span class="at">up=</span>upbL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  L.(Intercept)             seL low.(Intercept)  up.(Intercept) 
      287.60886        14.17804       258.90692       316.31081 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected food expenditure at income = $2000:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected food expenditure at income = $2000:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Point estimate:"</span>, <span class="fu">round</span>(L, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Point estimate: 287.61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Standard error:"</span>, <span class="fu">round</span>(seL, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Standard error: 14.18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI: ["</span>, <span class="fu">round</span>(lowbL, <span class="dv">2</span>), <span class="st">","</span>, <span class="fu">round</span>(upbL, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% CI: [ 258.91 , 316.31 ]</code></pre>
</div>
</div>
</section>
<section id="hypothesis-test-for-linear-combination" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis-test-for-linear-combination">Hypothesis Test for Linear Combination</h4>
<p><strong>Question:</strong> Is expected food expenditure significantly different from $250 at this income level?</p>
<p><span class="math display">\[
H_0: L = 250, \qquad H_A: L \ne 250.
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesized value</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test statistic</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (L <span class="sc">-</span> c)<span class="sc">/</span>seL</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value (two-tailed)</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t), df))</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">p_value=</span>p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      t.(Intercept) p_value.(Intercept) 
         2.65261316          0.01159078 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hypothesis test: H0: L = 250</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hypothesis test: H0: L = 250</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Test statistic:"</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Test statistic: 2.653 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p-value: 0.0116 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Decision at α=0.05:"</span>, <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Decision at α=0.05: Reject H0 </code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> We fail to reject the null hypothesis. There is insufficient evidence that expected food expenditure differs from $250 for households earning $2,000/week.</p>
</section>
<section id="part-d---mcqs" class="level4">
<h4 class="anchored" data-anchor-id="part-d---mcqs">PART D - MCQs</h4>
<div class="mcq-we">
<div class="mcq-we-q">
<strong>1) In hypothesis testing, H₀ represents:</strong><br>

<div id="radio_YDSDZJPYWL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YDSDZJPYWL" value=""> <span>The research hypothesis</span></label><label><input type="radio" autocomplete="off" name="radio_YDSDZJPYWL" value=""> <span>What we hope to prove</span></label><label><input type="radio" autocomplete="off" name="radio_YDSDZJPYWL" value="answer"> <span>The status quo or claim being tested</span></label><label><input type="radio" autocomplete="off" name="radio_YDSDZJPYWL" value=""> <span>The alternative explanation</span></label>
</div>
<span class="mcq-key" data-correct="The status quo or claim being tested"></span>
<details class="hint">
<summary>
Hint
</summary>
Think of it as the “innocent until proven guilty” claim.
</details>
</div>
<div class="mcq-we-q">
<strong>2) The test statistic t = (b - c) / se(b) measures:</strong><br>

<div id="radio_WCCYQUSWXG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WCCYQUSWXG" value=""> <span>The absolute error</span></label><label><input type="radio" autocomplete="off" name="radio_WCCYQUSWXG" value=""> <span>The confidence level</span></label><label><input type="radio" autocomplete="off" name="radio_WCCYQUSWXG" value="answer"> <span>How many standard errors b is from c</span></label><label><input type="radio" autocomplete="off" name="radio_WCCYQUSWXG" value=""> <span>The sample size</span></label>
</div>
<span class="mcq-key" data-correct="How many standard errors b is from c"></span>
<details class="hint">
<summary>
Hint
</summary>
It’s a standardized distance.
</details>
</div>
<div class="mcq-we-q">
<strong>3) For a two-tailed test at α = 0.05 with df = 38, the critical value is approximately:</strong><br>

<div id="radio_AILMRKTZPO" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_AILMRKTZPO" value=""> <span>1.645</span></label><label><input type="radio" autocomplete="off" name="radio_AILMRKTZPO" value=""> <span>1.686</span></label><label><input type="radio" autocomplete="off" name="radio_AILMRKTZPO" value="answer"> <span>±2.024</span></label><label><input type="radio" autocomplete="off" name="radio_AILMRKTZPO" value=""> <span>±1.96</span></label>
</div>
<span class="mcq-key" data-correct="±2.024"></span>
<details class="hint">
<summary>
Hint
</summary>
Use qt(0.975, 38) for the upper tail.
</details>
</div>
<div class="mcq-we-q">
<strong>4) A p-value of 0.03 means:</strong><br>

<div id="radio_HPFGNSWXJT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HPFGNSWXJT" value=""> <span>H₀ has 3% chance of being true</span></label><label><input type="radio" autocomplete="off" name="radio_HPFGNSWXJT" value=""> <span>There's a 3% chance the result is wrong</span></label><label><input type="radio" autocomplete="off" name="radio_HPFGNSWXJT" value="answer"> <span>If H₀ were true, there's a 3% chance of results this extreme</span></label><label><input type="radio" autocomplete="off" name="radio_HPFGNSWXJT" value=""> <span>The effect size is 3%</span></label>
</div>
<p><span class="mcq-key" data-correct="If H₀ were true, there's a 3% chance of results this extreme"></span></p>
</div>
<div class="mcq-we-q">
<strong>5) We reject H₀ when:</strong><br>

<div id="radio_PSDIEBLHLT" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PSDIEBLHLT" value="answer"> <span>p-value &lt; α</span></label><label><input type="radio" autocomplete="off" name="radio_PSDIEBLHLT" value=""> <span>p-value &gt; α</span></label><label><input type="radio" autocomplete="off" name="radio_PSDIEBLHLT" value=""> <span>t-statistic &lt; 0</span></label><label><input type="radio" autocomplete="off" name="radio_PSDIEBLHLT" value=""> <span>Confidence interval includes zero</span></label>
</div>
<p><span class="mcq-key" data-correct="p-value < α"></span></p>
</div>
<div class="mcq-we-q">
<strong>6) For a right-tailed test, the p-value is calculated as:</strong><br>

<div id="radio_AWSAWEIRLW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_AWSAWEIRLW" value=""> <span>pt(t, df)</span></label><label><input type="radio" autocomplete="off" name="radio_AWSAWEIRLW" value=""> <span>2 * pt(abs(t), df)</span></label><label><input type="radio" autocomplete="off" name="radio_AWSAWEIRLW" value="answer"> <span>1 - pt(t, df)</span></label><label><input type="radio" autocomplete="off" name="radio_AWSAWEIRLW" value=""> <span>pt(-t, df)</span></label>
</div>
<span class="mcq-key" data-correct="1 - pt(t, df)"></span>
<details class="hint">
<summary>
Hint
</summary>
We want the upper tail probability.
</details>
</div>
<div class="mcq-we-q">
<strong>7) A 95% confidence interval for β₂ is [3, 8]. In a two-tailed test at α = 0.05, we would:</strong><br>

<div id="radio_HCCMVBJJJK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HCCMVBJJJK" value=""> <span>Reject H₀: β₂ = 5</span></label><label><input type="radio" autocomplete="off" name="radio_HCCMVBJJJK" value="answer"> <span>Fail to reject H₀: β₂ = 5</span></label><label><input type="radio" autocomplete="off" name="radio_HCCMVBJJJK" value=""> <span>Reject H₀: β₂ = 0</span></label><label><input type="radio" autocomplete="off" name="radio_HCCMVBJJJK" value=""> <span>Need more information</span></label>
</div>
<span class="mcq-key" data-correct="Fail to reject H₀: β₂ = 5"></span>
<details class="hint">
<summary>
Hint
</summary>
5 is inside the interval.
</details>
</div>
<div class="mcq-we-q">
<strong>8) The same confidence interval [3, 8] tells us we would:</strong><br>

<div id="radio_RPZQCUBEKS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_RPZQCUBEKS" value=""> <span>Fail to reject H₀: β₂ = 0</span></label><label><input type="radio" autocomplete="off" name="radio_RPZQCUBEKS" value="answer"> <span>Reject H₀: β₂ = 0</span></label><label><input type="radio" autocomplete="off" name="radio_RPZQCUBEKS" value=""> <span>Accept H₀: β₂ = 10</span></label><label><input type="radio" autocomplete="off" name="radio_RPZQCUBEKS" value=""> <span>Reject H₀: β₂ = 6</span></label>
</div>
<span class="mcq-key" data-correct="Reject H₀: β₂ = 0"></span>
<details class="hint">
<summary>
Hint
</summary>
0 is outside the interval.
</details>
</div>
<div class="mcq-we-q">
<strong>9) To test L = β₁ + 20β₂, we need:</strong><br>

<div id="radio_GWOQSMFBVU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GWOQSMFBVU" value=""> <span>Only var(β₁) and var(β₂)</span></label><label><input type="radio" autocomplete="off" name="radio_GWOQSMFBVU" value=""> <span>Only the covariance</span></label><label><input type="radio" autocomplete="off" name="radio_GWOQSMFBVU" value="answer"> <span>Var(β₁), var(β₂), and cov(β₁, β₂)</span></label><label><input type="radio" autocomplete="off" name="radio_GWOQSMFBVU" value=""> <span>Just the point estimate</span></label>
</div>
<p><span class="mcq-key" data-correct="Var(β₁), var(β₂), and cov(β₁, β₂)"></span></p>
</div>
<div class="mcq-we-q">
<strong>10) The variance of L = a·X + b·Y includes the term:</strong><br>

<div id="radio_TUXTYMEAJU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TUXTYMEAJU" value=""> <span>ab · var(X)</span></label><label><input type="radio" autocomplete="off" name="radio_TUXTYMEAJU" value=""> <span>ab · var(Y)</span></label><label><input type="radio" autocomplete="off" name="radio_TUXTYMEAJU" value="answer"> <span>2ab · cov(X,Y)</span></label><label><input type="radio" autocomplete="off" name="radio_TUXTYMEAJU" value=""> <span>(a+b)² · var(X)</span></label>
</div>
<span class="mcq-key" data-correct="2ab · cov(X,Y)"></span>
<details class="hint">
<summary>
Hint
</summary>
Don’t forget the “2” and the product ab.
</details>
</div>
<div class="mcq-we-q">
<strong>11) vcov(model) returns:</strong><br>

<div id="radio_ORDFZTRJZW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ORDFZTRJZW" value=""> <span>Only variances</span></label><label><input type="radio" autocomplete="off" name="radio_ORDFZTRJZW" value=""> <span>Only covariances</span></label><label><input type="radio" autocomplete="off" name="radio_ORDFZTRJZW" value="answer"> <span>A matrix with variances on diagonal and covariances off-diagonal</span></label><label><input type="radio" autocomplete="off" name="radio_ORDFZTRJZW" value=""> <span>Confidence intervals</span></label>
</div>
<p><span class="mcq-key" data-correct="A matrix with variances on diagonal and covariances off-diagonal"></span></p>
</div>
<div class="mcq-we-q">
<strong>12) A Type I error occurs when:</strong><br>

<div id="radio_KFUEUZXZCJ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KFUEUZXZCJ" value=""> <span>We fail to reject a false H₀</span></label><label><input type="radio" autocomplete="off" name="radio_KFUEUZXZCJ" value="answer"> <span>We reject a true H₀</span></label><label><input type="radio" autocomplete="off" name="radio_KFUEUZXZCJ" value=""> <span>Our sample size is too small</span></label><label><input type="radio" autocomplete="off" name="radio_KFUEUZXZCJ" value=""> <span>The p-value is large</span></label>
</div>
<span class="mcq-key" data-correct="We reject a true H₀"></span>
<details class="hint">
<summary>
Hint
</summary>
It’s controlled by α.
</details>
</div>
<div class="mcq-we-q">
<strong>13) The significance level α represents:</strong><br>

<div id="radio_TOQNWEQIAH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TOQNWEQIAH" value=""> <span>The p-value</span></label><label><input type="radio" autocomplete="off" name="radio_TOQNWEQIAH" value=""> <span>The probability H₀ is true</span></label><label><input type="radio" autocomplete="off" name="radio_TOQNWEQIAH" value="answer"> <span>The probability of Type I error</span></label><label><input type="radio" autocomplete="off" name="radio_TOQNWEQIAH" value=""> <span>The power of the test</span></label>
</div>
<p><span class="mcq-key" data-correct="The probability of Type I error"></span></p>
</div>
<div class="mcq-we-q">
<strong>14) For H₀: β₂ = 0, if the 95% CI is [2.5, 7.5], then:</strong><br>

<div id="radio_PWNIDRNFMV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PWNIDRNFMV" value=""> <span>p-value &gt; 0.05</span></label><label><input type="radio" autocomplete="off" name="radio_PWNIDRNFMV" value="answer"> <span>p-value &lt; 0.05</span></label><label><input type="radio" autocomplete="off" name="radio_PWNIDRNFMV" value=""> <span>We cannot reject H₀</span></label><label><input type="radio" autocomplete="off" name="radio_PWNIDRNFMV" value=""> <span>The estimate is unbiased</span></label>
</div>
<span class="mcq-key" data-correct="p-value < 0.05"></span>
<details class="hint">
<summary>
Hint
</summary>
0 is not in the interval, so we reject.
</details>
</div>
<div class="mcq-we-q">
<strong>15) In R, to get the p-value for a right-tailed test with t = 2.5 and df = 30:</strong><br>

<div id="radio_LSEULIIOOQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LSEULIIOOQ" value=""> <span>pt(2.5, 30)</span></label><label><input type="radio" autocomplete="off" name="radio_LSEULIIOOQ" value=""> <span>2*pt(2.5, 30)</span></label><label><input type="radio" autocomplete="off" name="radio_LSEULIIOOQ" value="answer"> <span>1 - pt(2.5, 30)</span></label><label><input type="radio" autocomplete="off" name="radio_LSEULIIOOQ" value=""> <span>pt(2.5, 30, lower.tail=TRUE)</span></label>
</div>
<p><span class="mcq-key" data-correct="1 - pt(2.5, 30)"></span></p>
</div>
<div class="mcq-we-q">
<strong>16) A larger sample size generally:</strong><br>

<div id="radio_MCRPPZSSLU" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MCRPPZSSLU" value=""> <span>Increases standard errors</span></label><label><input type="radio" autocomplete="off" name="radio_MCRPPZSSLU" value="answer"> <span>Decreases standard errors</span></label><label><input type="radio" autocomplete="off" name="radio_MCRPPZSSLU" value=""> <span>Doesn't affect hypothesis tests</span></label><label><input type="radio" autocomplete="off" name="radio_MCRPPZSSLU" value=""> <span>Increases the critical value</span></label>
</div>
<span class="mcq-key" data-correct="Decreases standard errors"></span>
<details class="hint">
<summary>
Hint
</summary>
More data = more precision.
</details>
</div>
<div class="mcq-we-q">
<strong>17) The degrees of freedom for a simple regression (N=40) is:</strong><br>

<div id="radio_WENUVJWCLM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WENUVJWCLM" value=""> <span>40</span></label><label><input type="radio" autocomplete="off" name="radio_WENUVJWCLM" value=""> <span>39</span></label><label><input type="radio" autocomplete="off" name="radio_WENUVJWCLM" value="answer"> <span>38</span></label><label><input type="radio" autocomplete="off" name="radio_WENUVJWCLM" value=""> <span>37</span></label>
</div>
<span class="mcq-key" data-correct="38"></span>
<details class="hint">
<summary>
Hint
</summary>
df = N - K where K=2 (intercept + slope).
</details>
</div>
<div class="mcq-we-q">
<strong>18) If |t| &lt; t_critical, we:</strong><br>

<div id="radio_ZFMZBYBBWX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZFMZBYBBWX" value=""> <span>Reject H₀</span></label><label><input type="radio" autocomplete="off" name="radio_ZFMZBYBBWX" value="answer"> <span>Fail to reject H₀</span></label><label><input type="radio" autocomplete="off" name="radio_ZFMZBYBBWX" value=""> <span>Accept H₁</span></label><label><input type="radio" autocomplete="off" name="radio_ZFMZBYBBWX" value=""> <span>Recalculate the test</span></label>
</div>
<p><span class="mcq-key" data-correct="Fail to reject H₀"></span></p>
</div>
<div class="mcq-we-q">
<strong>19) A one-tailed test is appropriate when:</strong><br>

<div id="radio_GKCNMOEXKG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GKCNMOEXKG" value=""> <span>We don't know the direction</span></label><label><input type="radio" autocomplete="off" name="radio_GKCNMOEXKG" value=""> <span>We want more power</span></label><label><input type="radio" autocomplete="off" name="radio_GKCNMOEXKG" value="answer"> <span>Theory predicts a specific direction</span></label><label><input type="radio" autocomplete="off" name="radio_GKCNMOEXKG" value=""> <span>The sample size is small</span></label>
</div>
<p><span class="mcq-key" data-correct="Theory predicts a specific direction"></span></p>
</div>
<div class="mcq-we-q">
<strong>20) The t-distribution approaches the normal distribution as:</strong><br>

<div id="radio_BVGEQWUESN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BVGEQWUESN" value=""> <span>α decreases</span></label><label><input type="radio" autocomplete="off" name="radio_BVGEQWUESN" value=""> <span>α increases</span></label><label><input type="radio" autocomplete="off" name="radio_BVGEQWUESN" value=""> <span>n decreases</span></label><label><input type="radio" autocomplete="off" name="radio_BVGEQWUESN" value="answer"> <span>n increases</span></label>
</div>
<span class="mcq-key" data-correct="n increases"></span>
<details class="hint">
<summary>
Hint
</summary>
With large df, t ≈ z.
</details>
</div>
</div>
</section>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<ul>
<li>Hypothesis testing provides a formal framework for evaluating claims about parameters</li>
<li>Test statistics measure how far estimates are from hypothesized values in standard error units</li>
<li>p-values quantify the strength of evidence against H₀</li>
<li>Confidence intervals and hypothesis tests are mathematically equivalent</li>
<li>Linear combinations require accounting for covariances in variance calculations</li>
</ul>
<hr>
<p>🏁 <em>End of lab 9</em> 🛑 Remember to save your script 💾</p>
<hr>
<hr>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<p>Acemoglu, D., Laibson, D., &amp; List, J. A. (2015). Microeconomics (2nd ed.). Pearson. pp.&nbsp;512–530. (For conceptual understanding of regression interpretation and causal inference basics.)</p>
<p>Colonescu, C. (2022). Principles of Econometrics with R (Version 2.0). Open Textbook Library. Chapters 7–9. (Used directly in labs, matches the PoEdata package and R examples.)</p>
<p>Gujarati, D. N., Porter, D. C., &amp; Gunasekar, S. (2017). Basic Econometrics (5th ed.). McGraw-Hill Education. pp.&nbsp;126–150, 175–195. (For theory and assumptions behind simple and multiple linear regression.)</p>
<p>Stock, J. H., &amp; Watson, M. W. (2020). Introduction to Econometrics (4th ed.). Pearson. pp.&nbsp;97–121, 145–165. (For hypothesis testing, p-values, and model diagnostics.)</p>
<hr>
</section>
<section id="formative-test-this-test-does-not-carry-any-marks" class="level3">
<h3 class="anchored" data-anchor-id="formative-test-this-test-does-not-carry-any-marks">Formative Test (This test does NOT carry any marks)</h3>
<p><img src=".\pics/formative_assessment_1.PNG" class="img-fluid" alt="Click to start the MCQs test!"> <em>or link: <a href="https://forms.microsoft.com/Pages/ResponsePage.aspx?id=RQSlSfq9eUut41R7TzmG6e2v58mrCWNIjQV8bfnU-6tUMDEyV0lGR01JV1BIMEFSTVc1VEZWWkJFRS4u">MCQs test</a></em></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./supervision_1.html" class="pagination-link" aria-label="Supervision 1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Supervision 1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./supervision_3.html" class="pagination-link" aria-label="Supervision 3">
        <span class="nav-page-text"><span class="chapter-title">Supervision 3</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>