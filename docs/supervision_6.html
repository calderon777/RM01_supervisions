<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Supervision 6 ‚Äì Research Methods for Land Economy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./supervision_7.html" rel="next">
<link href="./supervision_5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-13f3b9144cfbd4bffe19d1212ca92176.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="icons.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./supervision_6.html"><span class="chapter-title">Supervision 6</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Research Methods for Land Economy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Welcome and Supervision Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_6.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Supervision 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervision_7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Supervision 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formative_test_sup3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">In-Class Exercise Sup 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formative_test_sup4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">In-Class Exercise Sup 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formative_test_sup5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">In-Class Exercise Sup 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_formative_test_sup2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Solution to In-class Sup 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_formative_test_sup3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Solution to In-class Sup 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_formative_test_sup4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Solution to in‚Äëclass Sup 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solution_formative_task_sup5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Solution to in‚Äëclass Sup 5</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lab-19-qualitative-dependent-variables-logit-vs-probit-on-the-hedonic-model" id="toc-lab-19-qualitative-dependent-variables-logit-vs-probit-on-the-hedonic-model" class="nav-link active" data-scroll-target="#lab-19-qualitative-dependent-variables-logit-vs-probit-on-the-hedonic-model">Lab 19 ‚Äî Qualitative Dependent Variables: Logit vs Probit on the Hedonic Model</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">üéØ Learning Outcomes</a></li>
  <li><a href="#setup-data" id="toc-setup-data" class="nav-link" data-scroll-target="#setup-data">üì¶ Setup &amp; Data</a></li>
  <li><a href="#from-continuous-to-binary-define-high-vs-low-price" id="toc-from-continuous-to-binary-define-high-vs-low-price" class="nav-link" data-scroll-target="#from-continuous-to-binary-define-high-vs-low-price">üß† From Continuous to Binary: Define High vs Low Price</a></li>
  <li><a href="#model-specification-same-rhs-as-supervision-5" id="toc-model-specification-same-rhs-as-supervision-5" class="nav-link" data-scroll-target="#model-specification-same-rhs-as-supervision-5">üß© Model Specification (same RHS as Supervision 5)</a></li>
  <li><a href="#estimation-fit-only-backward-selection-bic" id="toc-estimation-fit-only-backward-selection-bic" class="nav-link" data-scroll-target="#estimation-fit-only-backward-selection-bic">‚öôÔ∏è Estimation (fit only) + ü™ì Backward Selection (BIC)</a></li>
  <li><a href="#interpreting-effects-with-marginal-effects-ames" id="toc-interpreting-effects-with-marginal-effects-ames" class="nav-link" data-scroll-target="#interpreting-effects-with-marginal-effects-ames">üìà Interpreting Effects with Marginal Effects (AMEs)</a></li>
  <li><a href="#predicted-probabilities-agreement-between-models" id="toc-predicted-probabilities-agreement-between-models" class="nav-link" data-scroll-target="#predicted-probabilities-agreement-between-models">üîÆ Predicted Probabilities &amp; Agreement Between Models</a></li>
  <li><a href="#classification-diagnostics-roc-auc" id="toc-classification-diagnostics-roc-auc" class="nav-link" data-scroll-target="#classification-diagnostics-roc-auc">üß™ Classification Diagnostics: ROC &amp; AUC</a></li>
  <li><a href="#choosing-a-threshold-confusion-matrices" id="toc-choosing-a-threshold-confusion-matrices" class="nav-link" data-scroll-target="#choosing-a-threshold-confusion-matrices">‚úÇÔ∏è Choosing a Threshold &amp; Confusion Matrices</a></li>
  <li><a href="#final-takeaway" id="toc-final-takeaway" class="nav-link" data-scroll-target="#final-takeaway">Final takeaway</a></li>
  <li><a href="#what-to-report-suggested-structure" id="toc-what-to-report-suggested-structure" class="nav-link" data-scroll-target="#what-to-report-suggested-structure">üìù What to Report (suggested structure)</a></li>
  <li><a href="#checklist" id="toc-checklist" class="nav-link" data-scroll-target="#checklist">‚úÖ Checklist</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Supervision 6</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="lab-19-qualitative-dependent-variables-logit-vs-probit-on-the-hedonic-model" class="level2">
<h2 class="anchored" data-anchor-id="lab-19-qualitative-dependent-variables-logit-vs-probit-on-the-hedonic-model">Lab 19 ‚Äî Qualitative Dependent Variables: Logit vs Probit on the Hedonic Model</h2>
<blockquote class="blockquote">
<p>This supervision builds directly on <strong>Supervision 5</strong>. We will keep the <em>same</em> hedonic right-hand-side (RHS) variables, but transform the <strong>dependent variable</strong> into <strong>High vs Low Price</strong> using the sample median. You will fit <strong>logit</strong> and <strong>probit</strong> models, interpret <strong>marginal effects</strong>, and assess <strong>predictive performance</strong>.</p>
</blockquote>
<hr>
<section id="learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes">üéØ Learning Outcomes</h3>
<p>By the end of this lab you will be able to:</p>
<ol type="1">
<li>Transform a continuous target into a <strong>binary</strong> target using the <strong>median</strong>.</li>
<li>Fit <strong>Logit</strong> and <strong>Probit</strong> models in R with the same hedonic covariates used previously.</li>
<li>Interpret <strong>Average Marginal Effects (AMEs)</strong> in probability terms.</li>
<li>Compare model performance via <strong>ROC curves</strong> and <strong>AUC</strong>.</li>
<li>Build <strong>confusion matrices</strong> at a chosen threshold and compute basic metrics.</li>
</ol>
<hr>
<p>‚úîÔ∏è <strong>Step-by-step workflow</strong></p>
<ul>
<li><p>The sections follow a logical sequence:</p></li>
<li><p>Data setup</p></li>
<li><p>Binary transformation</p></li>
<li><p>Model estimation</p></li>
<li><p>Interpretation</p></li>
<li><p>Forecasting ‚Üí performance evaluation</p></li>
</ul>
<hr>
</section>
<section id="setup-data" class="level3">
<h3 class="anchored" data-anchor-id="setup-data">üì¶ Setup &amp; Data</h3>
<p>We reuse the dataset prepared in Supervision 5 (we called the dataset <code>df</code>, see Sup 5 - ‚ÄúData Preparation‚Äù).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If a package is missing on your machine, run install.packages("package name")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: install.packages("readr")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load core packages used in this lab</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)     <span class="co"># reading data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)     <span class="co"># data manipulation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)   <span class="co"># plotting</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional/advanced packages for inference and diagnostics</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># If missing, install as needed:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c("margins", "sandwich", "lmtest", "pROC"))</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)   <span class="co"># marginal effects</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)  <span class="co"># robust (HC) variance</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)    <span class="co"># coeftest with robust SE</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#git addinstall.packages("pROC", repos = "https://cloud.r-project.org")</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)      <span class="co"># ROC and AUC</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Load the data using Supervision 5 - Section: data preparation</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the path if your file is elsewhere.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick preview</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,918
Columns: 29
$ listing_id     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, ‚Ä¶
$ sale_price     &lt;dbl&gt; 215000, 105000, 172000, 244000, 189900, 195500, 213500,‚Ä¶
$ gr_liv_area    &lt;dbl&gt; 1656, 896, 1329, 2110, 1629, 1604, 1338, 1280, 1616, 18‚Ä¶
$ total_bsmt_sf  &lt;dbl&gt; 1080, 882, 1329, 2110, 928, 926, 1338, 1280, 1595, 994,‚Ä¶
$ lot_area       &lt;dbl&gt; 31770, 11622, 14267, 11160, 13830, 9978, 4920, 5005, 53‚Ä¶
$ bedroom_abv_gr &lt;dbl&gt; 3, 2, 3, 3, 3, 3, 2, 2, 2, 3, 3, 3, 3, 2, 1, 4, 4, 1, 2‚Ä¶
$ full_bath      &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 3, 2, 1, 1‚Ä¶
$ half_bath      &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0‚Ä¶
$ kitchen_abv_gr &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1‚Ä¶
$ overall_qual   &lt;ord&gt; Above_Average, Average, Above_Average, Good, Average, A‚Ä¶
$ overall_cond   &lt;ord&gt; Average, Above_Average, Above_Average, Average, Average‚Ä¶
$ year_built     &lt;dbl&gt; 1960, 1961, 1958, 1968, 1997, 1998, 2001, 1992, 1995, 1‚Ä¶
$ year_remod_add &lt;dbl&gt; 1960, 1961, 1958, 1968, 1998, 1998, 2001, 1992, 1996, 1‚Ä¶
$ exter_qual     &lt;ord&gt; Typical, Typical, Typical, Good, Typical, Typical, Good‚Ä¶
$ kitchen_qual   &lt;ord&gt; Typical, Typical, Good, Excellent, Typical, Good, Good,‚Ä¶
$ central_air    &lt;chr&gt; "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", ‚Ä¶
$ garage_cars    &lt;dbl&gt; 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2‚Ä¶
$ garage_area    &lt;dbl&gt; 528, 730, 312, 522, 482, 470, 582, 506, 608, 442, 440, ‚Ä¶
$ fireplace_qu   &lt;ord&gt; Good, No_Fireplace, No_Fireplace, Typical, Typical, Goo‚Ä¶
$ bldg_type      &lt;fct&gt; OneFam, OneFam, OneFam, OneFam, OneFam, OneFam, TwnhsE,‚Ä¶
$ house_style    &lt;fct&gt; One_Story, One_Story, One_Story, One_Story, Two_Story, ‚Ä¶
$ neighborhood   &lt;fct&gt; North_Ames, North_Ames, North_Ames, North_Ames, Gilbert‚Ä¶
$ ms_zoning      &lt;chr&gt; "Residential_Low_Density", "Residential_High_Density", ‚Ä¶
$ foundation     &lt;chr&gt; "CBlock", "CBlock", "CBlock", "CBlock", "PConc", "PConc‚Ä¶
$ baths_total    &lt;dbl&gt; 1.0, 1.0, 1.5, 2.5, 2.5, 2.5, 2.0, 2.0, 2.0, 2.5, 2.5, ‚Ä¶
$ age            &lt;dbl&gt; 50, 49, 52, 42, 13, 12, 9, 18, 15, 11, 17, 18, 12, 20, ‚Ä¶
$ remod_age      &lt;dbl&gt; 50, 49, 52, 42, 12, 12, 9, 18, 14, 11, 16, 3, 12, 20, 2‚Ä¶
$ ln_price       &lt;dbl&gt; 12.27839, 11.56172, 12.05525, 12.40492, 12.15425, 12.18‚Ä¶
$ ln_area        &lt;dbl&gt; 7.412160, 6.797940, 7.192182, 7.654443, 7.395722, 7.380‚Ä¶</code></pre>
</div>
</div>
<hr>
</section>
<section id="from-continuous-to-binary-define-high-vs-low-price" class="level3">
<h3 class="anchored" data-anchor-id="from-continuous-to-binary-define-high-vs-low-price">üß† From Continuous to Binary: Define High vs Low Price</h3>
<p>We create a binary target equal to <strong>1</strong> if <code>sale_price</code> is <strong>at least</strong> the sample median and <strong>0</strong> otherwise. The median splits the sample into two balanced groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample median of the sale price</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>price_med <span class="ot">&lt;-</span> <span class="fu">median</span>(df<span class="sc">$</span>sale_price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the binary dependent variable</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">high_price =</span> <span class="fu">as.integer</span>(sale_price <span class="sc">&gt;=</span> price_med))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check class balance</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>high_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
1442 1476 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>high_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1 
0.4941741 0.5058259 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
‚ú® Why logit &amp; probit exist (the <em>aha!</em> moment)
</div>
</div>
<div class="callout-body-container callout-body">
<p>OLS fails when the dependent variable is 0/1 because predicted values can be &lt;0 or &gt;1.</p>
<p>Instead of predicting price category directly, logit and probit assume:</p>
<blockquote class="blockquote">
<p>There is an <strong>unobserved (latent) index</strong> of ‚Äúhousing quality/value‚Äù and we only observe whether it crosses a threshold.</p>
</blockquote>
<p><span class="math inline">\(y_i^* = X_i \beta + \varepsilon_i
\quad\rightarrow\quad
y_i = \begin{cases}
1 &amp; \text{if } y_i^* &gt; 0 \\
0 &amp; \text{otherwise}
\end{cases}\)</span></p>
<p>The difference is the distribution of the error term <span class="math inline">\(\varepsilon\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>Assumption for ( )</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Logit</strong></td>
<td>Logistic distribution</td>
<td>Coefficients scale with <em>odds</em>.</td>
</tr>
<tr class="even">
<td><strong>Probit</strong></td>
<td>Normal distribution</td>
<td>Coefficients on <em>z-score</em> scale.</td>
</tr>
</tbody>
</table>
<p>Because logistic and normal are very similar:</p>
<blockquote class="blockquote">
<p><strong>Logit coefficient ‚âà 1.6 √ó probit coefficient</strong></p>
</blockquote>
<p>But both produce nearly <strong>identical predicted probabilities and classification</strong>.</p>
</div>
</div>
<hr>
</section>
<section id="model-specification-same-rhs-as-supervision-5" class="level3">
<h3 class="anchored" data-anchor-id="model-specification-same-rhs-as-supervision-5">üß© Model Specification (same RHS as Supervision 5)</h3>
<p>We keep the hedonic RHS unchanged. Only the outcome changed (continuous -&gt; binary).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hedonic formula reused for binary models</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>f_bin <span class="ot">&lt;-</span> high_price <span class="sc">~</span> ln_area <span class="sc">+</span> bedroom_abv_gr <span class="sc">+</span> baths_total <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  total_bsmt_sf <span class="sc">+</span> garage_cars <span class="sc">+</span> central_air <span class="sc">+</span> overall_qual <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  overall_cond <span class="sc">+</span> exter_qual <span class="sc">+</span> kitchen_qual <span class="sc">+</span> fireplace_qu <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  bldg_type <span class="sc">+</span> house_style <span class="sc">+</span> neighborhood</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="estimation-fit-only-backward-selection-bic" class="level3">
<h3 class="anchored" data-anchor-id="estimation-fit-only-backward-selection-bic">‚öôÔ∏è Estimation (fit only) + ü™ì Backward Selection (BIC)</h3>
<p>We now estimate the latent model using <code>glm()</code>:</p>
<p><span class="math inline">\(P(y = 1 \mid X) = \text{link}^{-1}(X\beta)\)</span></p>
<ul>
<li><code>logit</code> ‚Üí inverse-logit (<code>plogis()</code>): returns a probability via <em>odds</em></li>
<li><code>probit</code> ‚Üí normal CDF (<code>pnorm()</code>): returns a probability via <em>z-score</em></li>
</ul>
<p>Logit uses the logistic CDF <strong>(cumulative distribution function)</strong>; probit uses the (scaled) normal CDF. They almost overlap, which is why results are so similar and logit ‚âà 1.6 √ó probit in scale. Let‚Äôs compare the CDFs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic vs Probit (variance-matched) ‚Äî super short CDF plot</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>sd_match <span class="ot">&lt;-</span> pi <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">3</span>)              <span class="co"># match Normal variance to Logistic</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">plogis</span>(x), <span class="at">from=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">to=</span><span class="dv">6</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"Latent index (x)"</span>, <span class="at">ylab=</span><span class="st">"CDF"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"CDF: Logistic vs Normal (variance-matched)"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x, <span class="at">sd=</span>sd_match), <span class="at">from=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">to=</span><span class="dv">6</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"Logistic (logit)"</span>, <span class="st">"Normal scaled (probit)"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">bty=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_6_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the next chunk we <strong>suppress printing</strong> baseline models to avoid overwhelming output (too many variables). However, we run <strong>backward stepwise (BIC)</strong> and present a compact, readable table of that selected model. Coefficient signs and significance are typically very similar; logit coefficients are usually ~1.6√ó probit coefficients (scale difference).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Packages used in this chunk -------------------------------------------</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)      <span class="co"># data wrangling</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)      <span class="co"># tidy model outputs (term, estimate, std.error, statistic, p.value)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)    <span class="co"># clean up long variable names</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)         <span class="co"># neat tables</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)     <span class="co"># coeftest() with robust SEs</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)   <span class="co"># vcovHC() for robust (HC) variance</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Convert ordered factors to plain factors --------------------------------</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Why? Ordered factors produce polynomial contrasts (.L, .Q, ...) that are hard to interpret.</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Using plain factors yields standard dummies and lets step() drop/keep whole factors cleanly.</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">overall_qual =</span> <span class="fu">as.factor</span>(overall_qual),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">overall_cond =</span> <span class="fu">as.factor</span>(overall_cond),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">exter_qual   =</span> <span class="fu">as.factor</span>(exter_qual),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen_qual =</span> <span class="fu">as.factor</span>(kitchen_qual),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fireplace_qu =</span> <span class="fu">as.factor</span>(fireplace_qu),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">central_air  =</span> <span class="fu">as.factor</span>(central_air)  <span class="co"># ensure "Y"/"N" is categorical</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Fit full LOGIT &amp; PROBIT (we suppress long summaries for readability) ----</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>logit_full  <span class="ot">&lt;-</span> <span class="fu">glm</span>(f_bin, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>probit_full <span class="ot">&lt;-</span> <span class="fu">glm</span>(f_bin, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"probit"</span>))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Backward stepwise with BIC (k = log(n)) on both models ------------------</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC penalizes complexity more than AIC -&gt; typically a leaner, more generalizable model.</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>k_bic <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">nrow</span>(df))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>logit_bic  <span class="ot">&lt;-</span> <span class="fu">step</span>(logit_full,  <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">k =</span> k_bic, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>probit_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(probit_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">k =</span> k_bic, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Quick fit comparison (lower is better) ----------------------------------</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>bic_tab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">c</span>(<span class="st">"logit_bic"</span>, <span class="st">"probit_bic"</span>),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC   =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(logit_bic),  <span class="fu">AIC</span>(probit_bic)),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC   =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(logit_bic),  <span class="fu">BIC</span>(probit_bic))</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>bic_tab  <span class="co"># glance: which BIC-selected model scores better?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 √ó 3
  model        AIC   BIC
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 logit_bic  1251. 1418.
2 probit_bic 1266. 1433.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Keep BOTH models for downstream sections --------------------------------</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>main_logit <span class="ot">&lt;-</span> logit_bic   <span class="co"># LOGIT (BIC-selected)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>main_probit <span class="ot">&lt;-</span> probit_bic  <span class="co"># PROBIT (BIC-selected)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Also clarify which one is "best" by BIC ---------------------------------</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">BIC</span>(logit_bic) <span class="sc">&lt;</span> <span class="fu">BIC</span>(probit_bic)) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"‚úÖ BIC selects the LOGIT model as best (more parsimonious)."</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  logit_bic</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"‚úÖ BIC selects the PROBIT model as best (more parsimonious)."</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  probit_bic</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Helper: compact robust-SE table for any glm -----------------------------</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>make_compact_table <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, title_text) {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Robust HC1 variance-covariance and tidy coefficients</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  rob_vcov <span class="ot">&lt;-</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(mod, <span class="at">type =</span> <span class="st">"HC1"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(lmtest<span class="sc">::</span><span class="fu">coeftest</span>(mod, <span class="at">vcov. =</span> rob_vcov)) <span class="sc">|&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(p.value) <span class="sc">|&gt;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Friendlier labels for students (extend as needed)</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> term <span class="sc">|&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^ln_area$"</span>, <span class="st">"ln(living area)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^baths_total$"</span>, <span class="st">"Total baths"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^garage_cars$"</span>, <span class="st">"Garage capacity"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^central_airY$"</span>, <span class="st">"Central air: Yes"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^bldg_type"</span>, <span class="st">"Bldg type: "</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^house_style"</span>, <span class="st">"Style: "</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace</span>(<span class="st">"^neighborhood"</span>, <span class="st">"Nbh: "</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate  =</span> <span class="fu">round</span>(estimate, <span class="dv">4</span>),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">4</span>),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">4</span>),</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value   =</span> <span class="fu">round</span>(p.value, <span class="dv">4</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Render a gt table (no exotic functions to avoid errors)</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  out <span class="sc">|&gt;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(<span class="at">title =</span> title_text) <span class="sc">|&gt;</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="st">"Term"</span>, <span class="at">estimate =</span> <span class="st">"Coef"</span>, <span class="at">std.error =</span> <span class="st">"Robust SE"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="st">"z"</span>, <span class="at">p.value =</span> <span class="st">"p"</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(<span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">100</span>), <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>))</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Print compact tables for BOTH models ------------------------------------</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="fu">make_compact_table</span>(main_logit, <span class="st">"Logit (BIC-selected): Key Terms ‚Äî Robust SEs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="qeayjdrzqo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qeayjdrzqo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qeayjdrzqo thead, #qeayjdrzqo tbody, #qeayjdrzqo tfoot, #qeayjdrzqo tr, #qeayjdrzqo td, #qeayjdrzqo th {
  border-style: none;
}

#qeayjdrzqo p {
  margin: 0;
  padding: 0;
}

#qeayjdrzqo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qeayjdrzqo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qeayjdrzqo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qeayjdrzqo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qeayjdrzqo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qeayjdrzqo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qeayjdrzqo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qeayjdrzqo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qeayjdrzqo .gt_spanner_row {
  border-bottom-style: hidden;
}

#qeayjdrzqo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qeayjdrzqo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qeayjdrzqo .gt_from_md > :first-child {
  margin-top: 0;
}

#qeayjdrzqo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qeayjdrzqo .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qeayjdrzqo .gt_row_group_first td {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_row_group_first th {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qeayjdrzqo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_left {
  text-align: left;
}

#qeayjdrzqo .gt_center {
  text-align: center;
}

#qeayjdrzqo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qeayjdrzqo .gt_font_normal {
  font-weight: normal;
}

#qeayjdrzqo .gt_font_bold {
  font-weight: bold;
}

#qeayjdrzqo .gt_font_italic {
  font-style: italic;
}

#qeayjdrzqo .gt_super {
  font-size: 65%;
}

#qeayjdrzqo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qeayjdrzqo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qeayjdrzqo .gt_indent_1 {
  text-indent: 5px;
}

#qeayjdrzqo .gt_indent_2 {
  text-indent: 10px;
}

#qeayjdrzqo .gt_indent_3 {
  text-indent: 15px;
}

#qeayjdrzqo .gt_indent_4 {
  text-indent: 20px;
}

#qeayjdrzqo .gt_indent_5 {
  text-indent: 25px;
}

#qeayjdrzqo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qeayjdrzqo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Logit (BIC-selected): Key Terms ‚Äî Robust SEs</th>
</tr>
<tr class="gt_col_headings even">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Coef</th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Robust SE</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">z</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual^9</td>
<td class="gt_row gt_right" headers="estimate">15.1397</td>
<td class="gt_row gt_right" headers="std.error">0.7831</td>
<td class="gt_row gt_right" headers="statistic">19.3326</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">exter_qual.L</td>
<td class="gt_row gt_right" headers="estimate">-10.6344</td>
<td class="gt_row gt_right" headers="std.error">0.5561</td>
<td class="gt_row gt_right" headers="statistic">-19.1225</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual^4</td>
<td class="gt_row gt_right" headers="estimate">-12.5784</td>
<td class="gt_row gt_right" headers="std.error">0.7454</td>
<td class="gt_row gt_right" headers="statistic">-16.8753</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">exter_qual.Q</td>
<td class="gt_row gt_right" headers="estimate">7.0991</td>
<td class="gt_row gt_right" headers="std.error">0.6307</td>
<td class="gt_row gt_right" headers="statistic">11.2550</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Total baths</td>
<td class="gt_row gt_right" headers="estimate">1.7096</td>
<td class="gt_row gt_right" headers="std.error">0.2143</td>
<td class="gt_row gt_right" headers="statistic">7.9788</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">ln(living area)</td>
<td class="gt_row gt_right" headers="estimate">3.9021</td>
<td class="gt_row gt_right" headers="std.error">0.5224</td>
<td class="gt_row gt_right" headers="statistic">7.4689</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">total_bsmt_sf</td>
<td class="gt_row gt_right" headers="estimate">0.0020</td>
<td class="gt_row gt_right" headers="std.error">0.0003</td>
<td class="gt_row gt_right" headers="statistic">7.1608</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual.C</td>
<td class="gt_row gt_right" headers="estimate">-8.3438</td>
<td class="gt_row gt_right" headers="std.error">1.1840</td>
<td class="gt_row gt_right" headers="statistic">-7.0472</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual^5</td>
<td class="gt_row gt_right" headers="estimate">-5.4813</td>
<td class="gt_row gt_right" headers="std.error">0.7807</td>
<td class="gt_row gt_right" headers="statistic">-7.0212</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">exter_qual.C</td>
<td class="gt_row gt_right" headers="estimate">-4.1839</td>
<td class="gt_row gt_right" headers="std.error">0.7068</td>
<td class="gt_row gt_right" headers="statistic">-5.9199</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Garage capacity</td>
<td class="gt_row gt_right" headers="estimate">0.8858</td>
<td class="gt_row gt_right" headers="std.error">0.1569</td>
<td class="gt_row gt_right" headers="statistic">5.6446</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual.L</td>
<td class="gt_row gt_right" headers="estimate">-4.1405</td>
<td class="gt_row gt_right" headers="std.error">0.9283</td>
<td class="gt_row gt_right" headers="statistic">-4.4603</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Bldg type: OneFam</td>
<td class="gt_row gt_right" headers="estimate">2.0304</td>
<td class="gt_row gt_right" headers="std.error">0.5295</td>
<td class="gt_row gt_right" headers="statistic">3.8341</td>
<td class="gt_row gt_right" headers="p.value">0.0001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">bedroom_abv_gr</td>
<td class="gt_row gt_right" headers="estimate">-0.5331</td>
<td class="gt_row gt_right" headers="std.error">0.1417</td>
<td class="gt_row gt_right" headers="statistic">-3.7617</td>
<td class="gt_row gt_right" headers="p.value">0.0002</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual^8</td>
<td class="gt_row gt_right" headers="estimate">3.7655</td>
<td class="gt_row gt_right" headers="std.error">1.0726</td>
<td class="gt_row gt_right" headers="statistic">3.5106</td>
<td class="gt_row gt_right" headers="p.value">0.0004</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">Central air: Yes</td>
<td class="gt_row gt_right" headers="estimate">1.9202</td>
<td class="gt_row gt_right" headers="std.error">0.5563</td>
<td class="gt_row gt_right" headers="statistic">3.4518</td>
<td class="gt_row gt_right" headers="p.value">0.0006</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">fireplace_qu.Q</td>
<td class="gt_row gt_right" headers="estimate">0.9649</td>
<td class="gt_row gt_right" headers="std.error">0.3096</td>
<td class="gt_row gt_right" headers="statistic">3.1168</td>
<td class="gt_row gt_right" headers="p.value">0.0018</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">fireplace_qu^5</td>
<td class="gt_row gt_right" headers="estimate">-0.4994</td>
<td class="gt_row gt_right" headers="std.error">0.2292</td>
<td class="gt_row gt_right" headers="statistic">-2.1787</td>
<td class="gt_row gt_right" headers="p.value">0.0294</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Bldg type: TwoFmCon</td>
<td class="gt_row gt_right" headers="estimate">1.5261</td>
<td class="gt_row gt_right" headers="std.error">0.7411</td>
<td class="gt_row gt_right" headers="statistic">2.0594</td>
<td class="gt_row gt_right" headers="p.value">0.0395</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual^6</td>
<td class="gt_row gt_right" headers="estimate">1.1504</td>
<td class="gt_row gt_right" headers="std.error">0.6616</td>
<td class="gt_row gt_right" headers="statistic">1.7389</td>
<td class="gt_row gt_right" headers="p.value">0.0820</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_compact_table</span>(main_probit, <span class="st">"Probit (BIC-selected): Key Terms ‚Äî Robust SEs  üìå We will also use this downstream"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="xgdyentzro" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xgdyentzro table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xgdyentzro thead, #xgdyentzro tbody, #xgdyentzro tfoot, #xgdyentzro tr, #xgdyentzro td, #xgdyentzro th {
  border-style: none;
}

#xgdyentzro p {
  margin: 0;
  padding: 0;
}

#xgdyentzro .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xgdyentzro .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xgdyentzro .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xgdyentzro .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xgdyentzro .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xgdyentzro .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xgdyentzro .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xgdyentzro .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xgdyentzro .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xgdyentzro .gt_spanner_row {
  border-bottom-style: hidden;
}

#xgdyentzro .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xgdyentzro .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xgdyentzro .gt_from_md > :first-child {
  margin-top: 0;
}

#xgdyentzro .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xgdyentzro .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xgdyentzro .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xgdyentzro .gt_row_group_first td {
  border-top-width: 2px;
}

#xgdyentzro .gt_row_group_first th {
  border-top-width: 2px;
}

#xgdyentzro .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xgdyentzro .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xgdyentzro .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xgdyentzro .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xgdyentzro .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xgdyentzro .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xgdyentzro .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xgdyentzro .gt_left {
  text-align: left;
}

#xgdyentzro .gt_center {
  text-align: center;
}

#xgdyentzro .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xgdyentzro .gt_font_normal {
  font-weight: normal;
}

#xgdyentzro .gt_font_bold {
  font-weight: bold;
}

#xgdyentzro .gt_font_italic {
  font-style: italic;
}

#xgdyentzro .gt_super {
  font-size: 65%;
}

#xgdyentzro .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xgdyentzro .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xgdyentzro .gt_indent_1 {
  text-indent: 5px;
}

#xgdyentzro .gt_indent_2 {
  text-indent: 10px;
}

#xgdyentzro .gt_indent_3 {
  text-indent: 15px;
}

#xgdyentzro .gt_indent_4 {
  text-indent: 20px;
}

#xgdyentzro .gt_indent_5 {
  text-indent: 25px;
}

#xgdyentzro .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xgdyentzro div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Probit (BIC-selected): Key Terms ‚Äî Robust SEs üìå We will also use this downstream</th>
</tr>
<tr class="gt_col_headings even">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Coef</th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Robust SE</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">z</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="term">exter_qual.L</td>
<td class="gt_row gt_right" headers="estimate">-3.8454</td>
<td class="gt_row gt_right" headers="std.error">0.2067</td>
<td class="gt_row gt_right" headers="statistic">-18.5996</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual^4</td>
<td class="gt_row gt_right" headers="estimate">-3.2031</td>
<td class="gt_row gt_right" headers="std.error">0.2120</td>
<td class="gt_row gt_right" headers="statistic">-15.1082</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual^9</td>
<td class="gt_row gt_right" headers="estimate">4.2012</td>
<td class="gt_row gt_right" headers="std.error">0.3855</td>
<td class="gt_row gt_right" headers="statistic">10.8982</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">exter_qual.Q</td>
<td class="gt_row gt_right" headers="estimate">2.4456</td>
<td class="gt_row gt_right" headers="std.error">0.2911</td>
<td class="gt_row gt_right" headers="statistic">8.4024</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Total baths</td>
<td class="gt_row gt_right" headers="estimate">0.9290</td>
<td class="gt_row gt_right" headers="std.error">0.1245</td>
<td class="gt_row gt_right" headers="statistic">7.4616</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual.C</td>
<td class="gt_row gt_right" headers="estimate">-2.6018</td>
<td class="gt_row gt_right" headers="std.error">0.3538</td>
<td class="gt_row gt_right" headers="statistic">-7.3531</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">ln(living area)</td>
<td class="gt_row gt_right" headers="estimate">2.0371</td>
<td class="gt_row gt_right" headers="std.error">0.2844</td>
<td class="gt_row gt_right" headers="statistic">7.1631</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">total_bsmt_sf</td>
<td class="gt_row gt_right" headers="estimate">0.0011</td>
<td class="gt_row gt_right" headers="std.error">0.0002</td>
<td class="gt_row gt_right" headers="statistic">6.7114</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Garage capacity</td>
<td class="gt_row gt_right" headers="estimate">0.4570</td>
<td class="gt_row gt_right" headers="std.error">0.0933</td>
<td class="gt_row gt_right" headers="statistic">4.8984</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">exter_qual.C</td>
<td class="gt_row gt_right" headers="estimate">-1.6890</td>
<td class="gt_row gt_right" headers="std.error">0.3597</td>
<td class="gt_row gt_right" headers="statistic">-4.6950</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">Central air: Yes</td>
<td class="gt_row gt_right" headers="estimate">1.0294</td>
<td class="gt_row gt_right" headers="std.error">0.2772</td>
<td class="gt_row gt_right" headers="statistic">3.7132</td>
<td class="gt_row gt_right" headers="p.value">0.0002</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">Bldg type: OneFam</td>
<td class="gt_row gt_right" headers="estimate">1.0286</td>
<td class="gt_row gt_right" headers="std.error">0.3022</td>
<td class="gt_row gt_right" headers="statistic">3.4032</td>
<td class="gt_row gt_right" headers="p.value">0.0007</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">bedroom_abv_gr</td>
<td class="gt_row gt_right" headers="estimate">-0.2609</td>
<td class="gt_row gt_right" headers="std.error">0.0787</td>
<td class="gt_row gt_right" headers="statistic">-3.3141</td>
<td class="gt_row gt_right" headers="p.value">0.0009</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual^7</td>
<td class="gt_row gt_right" headers="estimate">-1.1811</td>
<td class="gt_row gt_right" headers="std.error">0.3584</td>
<td class="gt_row gt_right" headers="statistic">-3.2956</td>
<td class="gt_row gt_right" headers="p.value">0.0010</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">fireplace_qu.Q</td>
<td class="gt_row gt_right" headers="estimate">0.5618</td>
<td class="gt_row gt_right" headers="std.error">0.1757</td>
<td class="gt_row gt_right" headers="statistic">3.1978</td>
<td class="gt_row gt_right" headers="p.value">0.0014</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual^5</td>
<td class="gt_row gt_right" headers="estimate">-1.3032</td>
<td class="gt_row gt_right" headers="std.error">0.4239</td>
<td class="gt_row gt_right" headers="statistic">-3.0741</td>
<td class="gt_row gt_right" headers="p.value">0.0021</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">overall_qual.Q</td>
<td class="gt_row gt_right" headers="estimate">0.8228</td>
<td class="gt_row gt_right" headers="std.error">0.3084</td>
<td class="gt_row gt_right" headers="statistic">2.6678</td>
<td class="gt_row gt_right" headers="p.value">0.0076</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">overall_qual.L</td>
<td class="gt_row gt_right" headers="estimate">-0.7386</td>
<td class="gt_row gt_right" headers="std.error">0.2871</td>
<td class="gt_row gt_right" headers="statistic">-2.5723</td>
<td class="gt_row gt_right" headers="p.value">0.0101</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="term">fireplace_qu^5</td>
<td class="gt_row gt_right" headers="estimate">-0.2574</td>
<td class="gt_row gt_right" headers="std.error">0.1272</td>
<td class="gt_row gt_right" headers="statistic">-2.0234</td>
<td class="gt_row gt_right" headers="p.value">0.0430</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="term">Bldg type: TwoFmCon</td>
<td class="gt_row gt_right" headers="estimate">0.7736</td>
<td class="gt_row gt_right" headers="std.error">0.4246</td>
<td class="gt_row gt_right" headers="statistic">1.8219</td>
<td class="gt_row gt_right" headers="p.value">0.0685</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- (Optional) Kept vs Dropped list for transparency ------------------------</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment to show what BIC dropped vs. kept for each model.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># kept1   &lt;- attr(terms(main_logit), "term.labels"); full1 &lt;- attr(terms(logit_full),  "term.labels")</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># kept2   &lt;- attr(terms(main_probit), "term.labels"); full2 &lt;- attr(terms(probit_full), "term.labels")</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dropped1 &lt;- setdiff(full1, kept1); dropped2 &lt;- setdiff(full2, kept2)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble(model = "LOGIT", status = "Kept", term = kept1) |&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   bind_rows(tibble(model = "LOGIT", status = "Dropped", term = dropped1)) |&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   bind_rows(tibble(model = "PROBIT", status = "Kept", term = kept2)) |&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   bind_rows(tibble(model = "PROBIT", status = "Dropped", term = dropped2)) |&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   arrange(model, status, term) |&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   gt() |&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_header(title = "Backward BIC: Kept vs Dropped Terms (Logit &amp; Probit)") |&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   tab_options(table.width = pct(100))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Robust Standard Errors (recommended for cross-sections)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HC1 robust SEs using sandwich + lmtest</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(main_logit,  <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(main_logit,  <span class="at">type =</span> <span class="st">"HC1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                     Estimate  Std. Error  z value  Pr(&gt;|z|)    
(Intercept)       -3.5899e+01  3.8264e+00  -9.3819 &lt; 2.2e-16 ***
ln_area            3.9021e+00  5.2244e-01   7.4689 8.086e-14 ***
bedroom_abv_gr    -5.3308e-01  1.4171e-01  -3.7617 0.0001688 ***
baths_total        1.7096e+00  2.1427e-01   7.9788 1.478e-15 ***
total_bsmt_sf      1.9908e-03  2.7802e-04   7.1608 8.021e-13 ***
garage_cars        8.8578e-01  1.5693e-01   5.6446 1.656e-08 ***
central_airY       1.9202e+00  5.5629e-01   3.4518 0.0005569 ***
overall_qual.L    -4.1405e+00  9.2831e-01  -4.4603 8.185e-06 ***
overall_qual.Q     1.2659e+00  1.1710e+00   1.0811 0.2796449    
overall_qual.C    -8.3438e+00  1.1840e+00  -7.0472 1.825e-12 ***
overall_qual^4    -1.2578e+01  7.4537e-01 -16.8753 &lt; 2.2e-16 ***
overall_qual^5    -5.4813e+00  7.8068e-01  -7.0212 2.199e-12 ***
overall_qual^6     1.1504e+00  6.6158e-01   1.7389 0.0820451 .  
overall_qual^7    -1.3063e-01  7.9330e-01  -0.1647 0.8692110    
overall_qual^8     3.7655e+00  1.0726e+00   3.5106 0.0004472 ***
overall_qual^9     1.5140e+01  7.8312e-01  19.3326 &lt; 2.2e-16 ***
exter_qual.L      -1.0634e+01  5.5612e-01 -19.1225 &lt; 2.2e-16 ***
exter_qual.Q       7.0991e+00  6.3075e-01  11.2550 &lt; 2.2e-16 ***
exter_qual.C      -4.1839e+00  7.0676e-01  -5.9199 3.222e-09 ***
fireplace_qu.L    -1.9306e-01  3.6918e-01  -0.5230 0.6010086    
fireplace_qu.Q     9.6486e-01  3.0957e-01   3.1168 0.0018281 ** 
fireplace_qu.C     3.9833e-01  3.8274e-01   1.0407 0.2980044    
fireplace_qu^4    -7.1073e-02  3.7366e-01  -0.1902 0.8491463    
fireplace_qu^5    -4.9939e-01  2.2922e-01  -2.1787 0.0293574 *  
bldg_typeOneFam    2.0304e+00  5.2955e-01   3.8341 0.0001260 ***
bldg_typeTwnhs    -5.7459e-01  6.8362e-01  -0.8405 0.4006233    
bldg_typeTwnhsE    1.9953e-01  6.4498e-01   0.3094 0.7570455    
bldg_typeTwoFmCon  1.5261e+00  7.4106e-01   2.0594 0.0394569 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(main_probit, <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(main_probit, <span class="at">type =</span> <span class="st">"HC1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                     Estimate  Std. Error  z value  Pr(&gt;|z|)    
(Intercept)       -1.8833e+01  2.0729e+00  -9.0853 &lt; 2.2e-16 ***
ln_area            2.0371e+00  2.8439e-01   7.1631 7.889e-13 ***
bedroom_abv_gr    -2.6092e-01  7.8730e-02  -3.3141 0.0009193 ***
baths_total        9.2897e-01  1.2450e-01   7.4616 8.546e-14 ***
total_bsmt_sf      1.0688e-03  1.5925e-04   6.7114 1.927e-11 ***
garage_cars        4.5703e-01  9.3300e-02   4.8984 9.660e-07 ***
central_airY       1.0294e+00  2.7722e-01   3.7132 0.0002046 ***
overall_qual.L    -7.3856e-01  2.8713e-01  -2.5723 0.0101034 *  
overall_qual.Q     8.2278e-01  3.0841e-01   2.6678 0.0076351 ** 
overall_qual.C    -2.6018e+00  3.5383e-01  -7.3531 1.936e-13 ***
overall_qual^4    -3.2031e+00  2.1201e-01 -15.1082 &lt; 2.2e-16 ***
overall_qual^5    -1.3032e+00  4.2393e-01  -3.0741 0.0021117 ** 
overall_qual^6    -2.6588e-01  3.2419e-01  -0.8201 0.4121312    
overall_qual^7    -1.1811e+00  3.5838e-01  -3.2956 0.0009821 ***
overall_qual^8     3.6818e-01  5.6090e-01   0.6564 0.5115536    
overall_qual^9     4.2012e+00  3.8550e-01  10.8982 &lt; 2.2e-16 ***
exter_qual.L      -3.8454e+00  2.0675e-01 -18.5996 &lt; 2.2e-16 ***
exter_qual.Q       2.4456e+00  2.9106e-01   8.4024 &lt; 2.2e-16 ***
exter_qual.C      -1.6890e+00  3.5974e-01  -4.6950 2.666e-06 ***
fireplace_qu.L    -1.3497e-01  1.9931e-01  -0.6772 0.4982982    
fireplace_qu.Q     5.6178e-01  1.7568e-01   3.1978 0.0013850 ** 
fireplace_qu.C     2.1859e-01  2.1709e-01   1.0069 0.3139763    
fireplace_qu^4    -4.2936e-03  2.1376e-01  -0.0201 0.9839743    
fireplace_qu^5    -2.5744e-01  1.2724e-01  -2.0234 0.0430357 *  
bldg_typeOneFam    1.0286e+00  3.0224e-01   3.4032 0.0006659 ***
bldg_typeTwnhs    -3.3721e-01  3.8970e-01  -0.8653 0.3868682    
bldg_typeTwnhsE    1.3499e-01  3.6188e-01   0.3730 0.7091348    
bldg_typeTwoFmCon  7.7362e-01  4.2463e-01   1.8219 0.0684741 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why marginal effects?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Logit/probit coefficients are <strong>not</strong> changes in probability ‚Äî they change the <em>latent index</em>.</p>
<p>Marginal effects compute:</p>
<blockquote class="blockquote">
<p>‚ÄúHolding everything else constant, how does <span class="math inline">\(P(y=1)\)</span> change when <span class="math inline">\(x\)</span> increases by 1?‚Äù</p>
</blockquote>
<p>That is why AMEs are interpretable in <strong>percentage points</strong>.</p>
</div>
</div>
</section>
<section id="interpreting-effects-with-marginal-effects-ames" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-effects-with-marginal-effects-ames">üìà Interpreting Effects with Marginal Effects (AMEs)</h3>
<p>Raw coefficients are on latent/odds scales. <strong>Average Marginal Effects (AMEs)</strong> translate them to <strong>percentage-point changes in probability</strong> for a one-unit change in each predictor.</p>
<p>Logit/probit coefficients are not probabilities‚Äîthey shift the latent score, not <span class="math inline">\(P(Y=1)\)</span> directly. Marginal effects translate results into probability terms: ‚Äúby how many percentage points does <span class="math inline">\(P(Y=1)\)</span> change when a variable increases by one unit, holding others constant?‚Äù Average Marginal Effects (AMEs) average this change over all observations, so the numbers can be read directly in percentage-point terms. Use AMEs for clear, substantive interpretation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average Marginal Effects for both models</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>me_logit  <span class="ot">&lt;-</span> <span class="fu">margins</span>(main_logit)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>me_probit <span class="ot">&lt;-</span> <span class="fu">margins</span>(main_probit)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(me_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     factor     AME      SE       z      p    lower   upper
                baths_total  0.1052  0.0103 10.1961 0.0000   0.0850  0.1254
             bedroom_abv_gr -0.0328  0.0080 -4.1198 0.0000  -0.0484 -0.0172
            bldg_typeOneFam  0.1235  0.0282  4.3879 0.0000   0.0684  0.1787
             bldg_typeTwnhs -0.0367  0.0370 -0.9921 0.3212  -0.1093  0.0358
            bldg_typeTwnhsE  0.0125  0.0348  0.3608 0.7183  -0.0556  0.0807
          bldg_typeTwoFmCon  0.0933  0.0407  2.2886 0.0221   0.0134  0.1731
               central_airY  0.1196  0.0323  3.7083 0.0002   0.0564  0.1829
             exter_qualFair -0.4655  0.7340 -0.6341 0.5260  -1.9041  0.9732
             exter_qualGood -0.4043  0.7312 -0.5529 0.5803  -1.8373  1.0288
          exter_qualTypical -0.5041  0.7311 -0.6895 0.4905  -1.9369  0.9288
           fireplace_quFair -0.0314  0.1720 -0.1823 0.8554  -0.3685  0.3058
           fireplace_quGood -0.0345  0.1703 -0.2025 0.8395  -0.3683  0.2993
   fireplace_quNo_Fireplace -0.0953  0.1702 -0.5600 0.5755  -0.4289  0.2383
           fireplace_quPoor -0.0475  0.1730 -0.2747 0.7835  -0.3866  0.2915
        fireplace_quTypical  0.0002  0.1703  0.0013 0.9989  -0.3336  0.3341
                garage_cars  0.0545  0.0085  6.4286 0.0000   0.0379  0.0711
                    ln_area  0.2401  0.0299  8.0421 0.0000   0.1816  0.2986
        overall_qualAverage -0.0792  0.0153 -5.1632 0.0000  -0.1093 -0.0492
  overall_qualBelow_Average -0.1616  0.0354 -4.5675 0.0000  -0.2310 -0.0923
      overall_qualExcellent -0.0424  0.0888 -0.4776 0.6329  -0.2166  0.1317
           overall_qualFair -0.4835  0.9774 -0.4947 0.6208  -2.3991  1.4321
           overall_qualGood  0.0595  0.0181  3.2782 0.0010   0.0239  0.0951
           overall_qualPoor -0.4812  1.4431 -0.3334 0.7388  -3.3097  2.3473
 overall_qualVery_Excellent  0.4305 23.4932  0.0183 0.9854 -45.6152 46.4763
      overall_qualVery_Good  0.2160  0.0462  4.6738 0.0000   0.1254  0.3066
      overall_qualVery_Poor -0.4822  1.2336 -0.3909 0.6959  -2.9000  1.9356
              total_bsmt_sf  0.0001  0.0000  8.2160 0.0000   0.0001  0.0002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(me_probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     factor     AME      SE       z      p    lower   upper
                baths_total  0.1077  0.0106 10.1842 0.0000   0.0870  0.1285
             bedroom_abv_gr -0.0303  0.0081 -3.7268 0.0002  -0.0462 -0.0143
            bldg_typeOneFam  0.1178  0.0273  4.3118 0.0000   0.0643  0.1713
             bldg_typeTwnhs -0.0397  0.0371 -1.0709 0.2842  -0.1124  0.0330
            bldg_typeTwnhsE  0.0157  0.0340  0.4622 0.6439  -0.0510  0.0824
          bldg_typeTwoFmCon  0.0888  0.0413  2.1505 0.0315   0.0079  0.1698
               central_airY  0.1208  0.0320  3.7760 0.0002   0.0581  0.1836
             exter_qualFair -0.4737  0.9976 -0.4749 0.6349  -2.4290  1.4815
             exter_qualGood -0.3996  0.9951 -0.4016 0.6880  -2.3501  1.5508
          exter_qualTypical -0.5063  0.9951 -0.5088 0.6109  -2.4566  1.4441
           fireplace_quFair -0.0386  0.1353 -0.2854 0.7753  -0.3038  0.2266
           fireplace_quGood -0.0419  0.1330 -0.3150 0.7528  -0.3027  0.2189
   fireplace_quNo_Fireplace -0.1030  0.1330 -0.7746 0.4386  -0.3636  0.1576
           fireplace_quPoor -0.0593  0.1370 -0.4327 0.6652  -0.3277  0.2092
        fireplace_quTypical -0.0040  0.1331 -0.0303 0.9758  -0.2650  0.2569
                garage_cars  0.0530  0.0087  6.0966 0.0000   0.0360  0.0700
                    ln_area  0.2363  0.0302  7.8258 0.0000   0.1771  0.2955
        overall_qualAverage -0.0868  0.0159 -5.4681 0.0000  -0.1179 -0.0557
  overall_qualBelow_Average -0.1528  0.0339 -4.5071 0.0000  -0.2192 -0.0863
      overall_qualExcellent -0.1140  0.0652 -1.7473 0.0806  -0.2418  0.0139
           overall_qualFair -0.4761  2.2142 -0.2150 0.8298  -4.8159  3.8637
           overall_qualGood  0.0638  0.0184  3.4662 0.0005   0.0277  0.0999
           overall_qualPoor -0.3782 29.5342 -0.0128 0.9898 -58.2641 57.5077
 overall_qualVery_Excellent  0.0921 26.3486  0.0035 0.9972 -51.5502 51.7344
      overall_qualVery_Good  0.1886  0.0420  4.4916 0.0000   0.1063  0.2709
      overall_qualVery_Poor -0.4340 35.3525 -0.0123 0.9902 -69.7235 68.8555
              total_bsmt_sf  0.0001  0.0000  8.2283 0.0000   0.0001  0.0002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tip for reporting:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># "A 0.01 increase in ln_area (~1% more area) changes the probability of being high-priced by X percentage points (AME)."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="predicted-probabilities-agreement-between-models" class="level3">
<h3 class="anchored" data-anchor-id="predicted-probabilities-agreement-between-models">üîÆ Predicted Probabilities &amp; Agreement Between Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities from each model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_logit  =</span> <span class="fu">predict</span>(main_logit,  <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_probit =</span> <span class="fu">predict</span>(main_probit, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare probability predictions</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>p_logit, df<span class="sc">$</span>p_probit, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9993592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>p_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00000 0.02626 0.49132 0.50583 0.97866 1.00000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>p_probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00000 0.02449 0.48779 0.50484 0.98036 1.00000 </code></pre>
</div>
</div>
<hr>
</section>
<section id="classification-diagnostics-roc-auc" class="level3">
<h3 class="anchored" data-anchor-id="classification-diagnostics-roc-auc">üß™ Classification Diagnostics: ROC &amp; AUC</h3>
<p>An ROC (Receiver Operating Characteristic) curve is a graph that shows a classifier‚Äôs performance by plotting the true positive rate against the false positive rate at various threshold settings. The AUC (Area Under the Curve) is a single summary metric that measures how well a model can distinguish between classes, with a higher value indicating better performance. A perfect classifier has an AUC of (1.0), while a random classifier has an AUC of (0.5).&nbsp;</p>
<p>We evaluate ranking performance via <strong>ROC curves</strong> and <strong>AUC</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ROC intuition
</div>
</div>
<div class="callout-body-container callout-body">
<p>ROC doesn‚Äôt evaluate the predicted <strong>probability</strong>, but the <strong>ranking quality</strong>.</p>
<blockquote class="blockquote">
<p>‚ÄúAmong all pairs of houses, how often does the model rank the expensive one higher?‚Äù</p>
</blockquote>
<ul>
<li>AUC = 0.5 ‚Üí random odds</li>
<li>AUC = 1.0 ‚Üí perfect ranking</li>
</ul>
</div>
</div>
<p>A ROC curve evaluates how well the model ranks positives above negatives across all possible thresholds. It does not measure overall ‚Äúpercent correct,‚Äù but the trade-off between true positive rate (sensitivity) and false positive rate as the cutoff moves. The AUC summarizes ranking ability from 0.5 (random) to 1.0 (perfect). Two models can have similar accuracy at one cutoff yet different AUCs, which is why ROC/AUC is informative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC objects (treating 1 as the positive class)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>roc_logit  <span class="ot">&lt;-</span> <span class="fu">roc</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_logit)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>roc_probit <span class="ot">&lt;-</span> <span class="fu">roc</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_probit)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC values</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.9746</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.9745</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple ROC plots with ggplot2</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>autoplot_roc <span class="ot">&lt;-</span> <span class="cf">function</span>(roc_obj, title){</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build a data frame with TPR (sensitivity) and FPR (1 - specificity)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tpr =</span> roc_obj<span class="sc">$</span>sensitivities,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fpr =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj<span class="sc">$</span>specificities</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> fpr, <span class="at">y =</span> tpr)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"False Positive Rate"</span>, <span class="at">y =</span> <span class="st">"True Positive Rate"</span>, <span class="at">title =</span> title)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot_roc</span>(roc_logit,  <span class="fu">paste0</span>(<span class="st">"ROC ‚Äì Logit (AUC = "</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc_logit), <span class="dv">3</span>), <span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_6_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot_roc</span>(roc_probit, <span class="fu">paste0</span>(<span class="st">"ROC ‚Äì Probit (AUC = "</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc_probit), <span class="dv">3</span>), <span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="supervision_6_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="choosing-a-threshold-confusion-matrices" class="level3">
<h3 class="anchored" data-anchor-id="choosing-a-threshold-confusion-matrices">‚úÇÔ∏è Choosing a Threshold &amp; Confusion Matrices</h3>
<p>Classification requires a threshold on predicted probabilities. The <strong>Youden J</strong> criterion often gives a better cut-off than the na√Øve 0.5.</p>
<p>Choosing a single cutoff is a separate decision from estimating probabilities. The default 0.5 is arbitrary and may be sub-optimal when the costs of false positives and false negatives differ. The Youden J statistic selects the threshold that maximizes sensitivity + specificity ‚àí 1, giving a balanced operating point. We will compare results at 0.5 and at the Youden-optimal threshold</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal thresholds by Youden's J</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>thr_logit  <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_logit,  <span class="at">x =</span> <span class="st">"best"</span>, <span class="at">best.method =</span> <span class="st">"youden"</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)[<span class="st">"threshold"</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>thr_probit <span class="ot">&lt;-</span> <span class="fu">coords</span>(roc_probit, <span class="at">x =</span> <span class="st">"best"</span>, <span class="at">best.method =</span> <span class="st">"youden"</span>, <span class="at">transpose =</span> <span class="cn">TRUE</span>)[<span class="st">"threshold"</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>thr_logit; thr_probit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>threshold 
0.4980051 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>threshold 
0.4479988 </code></pre>
</div>
</div>
<p>A confusion matrix maps predictions to actuals and classifies outcomes into four cells: True Positive (correct 1), False Positive (false alarm), False Negative (missed 1), and True Negative (correct 0). Sensitivity = TP/(TP+FN) is a rate ‚Äúhow many actual true positives we catch from all true positives?‚Äù</p>
<p>Specificity = TN/(TN+FP) asks ‚Äúhow many actual 0s did we avoid flagging?‚Äù</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper to compute a confusion matrix and basic metrics without extra packages</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>confusion_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(y_true, y_prob, <span class="at">thr =</span> <span class="fl">0.5</span>) {</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(y_prob <span class="sc">&gt;=</span> thr, <span class="dv">1</span>L, <span class="dv">0</span>L)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(y_pred <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> y_true <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> <span class="fu">sum</span>(y_pred <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> y_true <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(y_pred <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> y_true <span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> <span class="fu">sum</span>(y_pred <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> y_true <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">&lt;-</span> (TP <span class="sc">+</span> TN) <span class="sc">/</span> (TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  tpr <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FN)  <span class="co"># sensitivity / recall</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  tnr <span class="ot">&lt;-</span> TN <span class="sc">/</span> (TN <span class="sc">+</span> FP)  <span class="co"># specificity</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  ppv <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FP)  <span class="co"># precision</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  npv <span class="ot">&lt;-</span> TN <span class="sc">/</span> (TN <span class="sc">+</span> FN)  <span class="co"># negative predicted value</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> thr,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">matrix =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(TN, FP, FN, TP), <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="st">"Predicted"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"1"</span>), <span class="st">"Actual"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"1"</span>))),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> acc, <span class="at">sensitivity =</span> tpr, <span class="at">specificity =</span> tnr, <span class="at">precision =</span> ppv, <span class="at">npv =</span> npv</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrices at 0.5 and at the optimal Youden threshold</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>cm_logit_05 <span class="ot">&lt;-</span> <span class="fu">confusion_metrics</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_logit,  <span class="at">thr =</span> <span class="fl">0.5</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>cm_probit_05 <span class="ot">&lt;-</span> <span class="fu">confusion_metrics</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_probit, <span class="at">thr =</span> <span class="fl">0.5</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>cm_logit_opt <span class="ot">&lt;-</span> <span class="fu">confusion_metrics</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_logit,  <span class="at">thr =</span> <span class="fu">as.numeric</span>(thr_logit))</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>cm_probit_opt <span class="ot">&lt;-</span> <span class="fu">confusion_metrics</span>(df<span class="sc">$</span>high_price, df<span class="sc">$</span>p_probit, <span class="at">thr =</span> <span class="fu">as.numeric</span>(thr_probit))</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>cm_logit_05</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$threshold
[1] 0.5

$matrix
         Actual
Predicted    0    1
        0 1333  134
        1  109 1342

$accuracy
[1] 0.9167238

$sensitivity
[1] 0.9092141

$specificity
[1] 0.9244105

$precision
[1] 0.9248794

$npv
[1] 0.9086571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cm_probit_05</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$threshold
[1] 0.5

$matrix
         Actual
Predicted    0    1
        0 1330  140
        1  112 1336

$accuracy
[1] 0.9136395

$sensitivity
[1] 0.9051491

$specificity
[1] 0.9223301

$precision
[1] 0.9226519

$npv
[1] 0.9047619</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cm_logit_opt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$threshold
[1] 0.4980051

$matrix
         Actual
Predicted    0    1
        0 1333  132
        1  109 1344

$accuracy
[1] 0.9174092

$sensitivity
[1] 0.9105691

$specificity
[1] 0.9244105

$precision
[1] 0.9249828

$npv
[1] 0.9098976</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cm_probit_opt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$threshold
[1] 0.4479988

$matrix
         Actual
Predicted    0    1
        0 1310  109
        1  132 1367

$accuracy
[1] 0.9174092

$sensitivity
[1] 0.9261518

$specificity
[1] 0.9084605

$precision
[1] 0.9119413

$npv
[1] 0.9231853</code></pre>
</div>
</div>
</section>
<section id="final-takeaway" class="level3 callout-success">
<h3 class="anchored" data-anchor-id="final-takeaway">Final takeaway</h3>
<ul>
<li>Logit and probit tell the <em>same economic story</em></li>
<li>AMEs let us interpret effects in <strong>percentage points</strong></li>
<li>ROC/Youden threshold evaluates predictive/classification performance</li>
</ul>
</section>
<hr>
<section id="what-to-report-suggested-structure" class="level3">
<h3 class="anchored" data-anchor-id="what-to-report-suggested-structure">üìù What to Report (suggested structure)</h3>
<ol type="1">
<li><strong>Model setup</strong>: how the binary target was defined; why the median.</li>
<li><strong>Estimation</strong>: logit &amp; probit results; include <strong>robust SE</strong> tables.</li>
<li><strong>Interpretation</strong>: <strong>AMEs</strong> for key variables (e.g., <code>ln_area</code>, <code>overall_qual</code>, <code>baths_total</code>).</li>
<li><strong>Performance</strong>: AUC for both models; comment on similarity/differences.</li>
<li><strong>Classification</strong>: confusion matrices at 0.5 and at the Youden-optimal threshold; discuss trade-offs.</li>
<li><strong>Reflection</strong>: when would you prefer logit vs probit? (Hint: results are usually very similar; choice often driven by convention or interpretability.)</li>
</ol>
<hr>
</section>
<section id="checklist" class="level3">
<h3 class="anchored" data-anchor-id="checklist">‚úÖ Checklist</h3>
<ul class="task-list">
<li><label><input type="checkbox">Code runs from top to bottom <strong>without manual edits</strong>.</label></li>
<li><label><input type="checkbox">All variables in your RHS are present/constructed.</label></li>
<li><label><input type="checkbox">You report <strong>robust SEs</strong> and <strong>AMEs</strong>.</label></li>
<li><label><input type="checkbox">You include <strong>AUC</strong> and describe <strong>threshold choice</strong>.</label></li>
<li><label><input type="checkbox">Your interpretations are in <strong>probability</strong> (percentage-point) terms.</label></li>
</ul>
<hr>
<p>üèÅ <em>End of Supervision 6</em><br>
üõë Remember to save your script üíæ</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./supervision_5.html" class="pagination-link" aria-label="Supervision 5">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Supervision 5</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./supervision_7.html" class="pagination-link" aria-label="Supervision 7">
        <span class="nav-page-text"><span class="chapter-title">Supervision 7</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>