---
title: "Supervision 5"
format: html

---

## Lab 18 - Hedonic Price Modelling: The Golden Regression Challenge

### üéØ Learning Outcomes

By the end of this supervision, you should be able to:

- Apply the concept of **hedonic pricing** to a real dataset.  
- Develop and justify a **regression model** explaining variation in house prices.  
- Evaluate competing model specifications and defend modelling choices.  
- Communicate results clearly to peers and engage in critical discussion.  

---

### Part A ‚Äî Data Preparation

In this supervision, we will use the **Ames Housing** dataset (De Cock, 2011), a real dataset widely used in econometrics and data science to study housing markets. It contains information on residential properties in Ames, Iowa, USA, including price, structural features, and neighbourhood characteristics.

> *Note: Although the dataset is U.S.-based, the economic reasoning behind hedonic pricing is fully applicable to UK housing markets.*

The following R code generates a cleaned dataset called **`hedonic_ames.csv`**. Run this once before starting your analysis.

```{r}
# Packages
if (!requireNamespace("AmesHousing", quietly = TRUE)) {
  install.packages("AmesHousing")
}
library(AmesHousing)
library(dplyr)
library(readr)
library(janitor)
library(stringr)

# Load full Ames data
ames <- AmesHousing::make_ames()

# Minimal cleaning and selection
df <- ames %>%
  janitor::clean_names() %>%
  dplyr::transmute(
    sale_price,
    gr_liv_area, total_bsmt_sf, lot_area,
    bedroom_abv_gr, full_bath, half_bath, kitchen_abv_gr,
    overall_qual, overall_cond, year_built, year_remod_add,
    exter_qual, kitchen_qual, central_air,
    garage_cars, garage_area, fireplace_qu,
    bldg_type, house_style, neighborhood,
    ms_zoning, foundation
  ) %>%
  dplyr::mutate(
    central_air = factor(central_air, levels = c("N","Y")),
    exter_qual = factor(exter_qual, ordered = TRUE),
    kitchen_qual = factor(kitchen_qual, ordered = TRUE),
    fireplace_qu = factor(fireplace_qu, ordered = TRUE),
    bldg_type = factor(bldg_type),
    house_style = factor(house_style),
    neighborhood = factor(neighborhood),
    ms_zoning = factor(ms_zoning),
    foundation = factor(foundation),
    baths_total = full_bath + 0.5 * half_bath,
    age = pmax(0, 2010 - year_built),
    remod_age = pmax(0, 2010 - year_remod_add)
  ) %>%
  dplyr::filter(
    sale_price > 20000, sale_price < 600000, 
    gr_liv_area > 300, lot_area < 100000
  ) %>%
  tidyr::drop_na(sale_price, gr_liv_area, bedroom_abv_gr, baths_total, overall_qual)

set.seed(42)
df <- df %>% dplyr::mutate(listing_id = dplyr::row_number()) %>% dplyr::relocate(listing_id)

readr::write_csv(df, "hedonic_ames.csv")

# Quick check
dplyr::glimpse(df)
```

---

### Part B ‚Äî Building the Hedonic Model

#### Task Overview

You are asked to **build and justify your own hedonic price model** using the dataset `hedonic_ames.csv`.  
Your model should explain the variation in **`sale_price`** using relevant structural and locational characteristics.  

Your submission should include:

1. Your **final regression model**, clearly identified in your R script.  
2. A short **comment block** describing your **variable selection process** (theory-driven, data-driven, or hybrid).  
3. A concise reflection on the **advantages and limitations** of your model.  

#### Suggested Workflow

```{r}
library(readr); library(dplyr); library(ggplot2); library(broom); library(modelsummary)

# 1. Load data
df <- read_csv("hedonic_ames.csv")

# 2. Transform variables (example)
df <- df %>% mutate(
  ln_price = log(sale_price),
  ln_area  = log(gr_liv_area),
  ln_lot   = log(lot_area)
)

# 3. Baseline hedonic model (example)
m0 <- lm(ln_price ~ ln_area + bedroom_abv_gr + baths_total + total_bsmt_sf +
           garage_cars + central_air + overall_qual + overall_cond +
           exter_qual + kitchen_qual + fireplace_qu +
           bldg_type + house_style + neighborhood,
         data = df)

modelsummary::modelsummary(list("Baseline" = m0))
```

> You are encouraged to experiment with transformations, interactions (e.g., `overall_qual:ln_area`), and diagnostic checks. Consider theoretical coherence and interpretability when finalising your model.

---

### Part C ‚Äî The Golden Regression Challenge

This supervision introduces a friendly competition: **who can design the best hedonic price model?**  
Your goal is to balance **theory, interpretability, and performance** ‚Äî not just maximise \( R^2 \).  

#### üèÜ Model Competition Criteria

Each model will be assessed based on:  

| Criterion | Description |
|------------|-------------|
| **Theoretical Consistency** | Does the model align with economic logic (e.g., diminishing returns to size)? |
| **Specification Quality** | Are relevant variables included, with clear reasoning for inclusion/exclusion? |
| **Interpretability** | Are coefficients easy to explain to a non-technical audience? |
| **Diagnostics & Fit** | Are residuals and assumptions checked appropriately? |
| **Presentation & Clarity** | Is the code organised, commented, and results clearly communicated? |

#### üèÖ The Golden Regression Medal

The most balanced and insightful model ‚Äî not necessarily the one with the highest \( R^2 \) ‚Äî will receive the **Golden Regression Medal**, a symbolic award crafted from real chocolate to honour econometric creativity and rigour.  

> *The sweetest prize for the sharpest model.* üç´  

Winners will briefly present their model in class, explaining their specification process, key findings, and what makes their model stand out.  

---

### Teaching Notes

- **Purpose:** Reinforce understanding of hedonic modelling through practical, student-led model design.  
- **Suggested timing:**  
  - 10 mins ‚Äî Recap on hedonic pricing and discussion of expected signs.  
  - 25‚Äì30 mins ‚Äî Student model work or team comparison.  
  - 20 mins ‚Äî Model presentations and peer discussion.  
  - 5 mins ‚Äî Announcement of the Golden Regression Medal winner.  

- **Instructor guidance:**  
  - Encourage students to justify variable choices theoretically before testing them empirically.  
  - Emphasise that interpretability and clarity outweigh brute statistical performance.  
  - Select diverse models for presentation to illustrate different modelling strategies.  
  - Optionally, showcase one well-specified example model at the end for reflection.  

- **Extension ideas:**  
  - Compare log-linear vs. linear specifications.  
  - Discuss omitted variable bias or potential endogeneity (briefly).  
  - Ask students how they might adapt the model for the UK housing market.  

---

üèÅ  *End of lab 18*
üõë Remember to save your script üíæ

---